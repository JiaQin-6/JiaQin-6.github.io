(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a688072"],{"6e09":function(t,e,i){},a155:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("b-row",[i("b-col",{attrs:{md:"12"}},[i("b-card",{attrs:{title:"user-library-card"===t.route_type?t.$t("reader_manage.reader_library_card.Printing_library_card"):t.$t("reader_manage.reader_library_card.Printing_Reading_Barcodes")}},[i("b-row",[i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("paper_width")+"（mm）"}},[i("b-form-input",{attrs:{type:"number",placeholder:t.$t("paper_width")+"（mm）"},model:{value:t.paperWidth,callback:function(e){t.paperWidth=e},expression:"paperWidth"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("paper_height")+"（mm）"}},[i("b-form-input",{attrs:{type:"number",placeholder:t.$t("paper_height")+"（mm）"},model:{value:t.paperHeight,callback:function(e){t.paperHeight=e},expression:"paperHeight"}})],1)],1)],1),i("b-row",{staticStyle:{"margin-bottom":"10px","align-items":"center"}},[i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("width")}},[i("b-form-input",{attrs:{placeholder:t.$t("width")+"（mm）"},on:{blur:function(){t.width=Number(t.width)||0}},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("height")}},[i("b-form-input",{attrs:{placeholder:t.$t("height")+"（mm）"},on:{blur:function(){t.height=Number(t.height)||0}},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("col_number")}},[i("b-form-input",{attrs:{placeholder:t.$t("col_number"),type:"number"},on:{blur:function(){t.row=Number(t.row)||0}},model:{value:t.row,callback:function(e){t.row=e},expression:"row"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("row_number")}},[i("b-form-input",{attrs:{placeholder:t.$t("row_number"),type:"number"},on:{blur:function(){t.column=Number(t.column)||0}},model:{value:t.column,callback:function(e){t.column=e},expression:"column"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:"margin top（mm）"}},[i("b-form-input",{attrs:{placeholder:"margin top",type:"number"},on:{blur:function(){t.margin_top=Number(t.margin_top)||0}},model:{value:t.margin_top,callback:function(e){t.margin_top=e},expression:"margin_top"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:"margin bottom（mm）"}},[i("b-form-input",{attrs:{placeholder:"margin bottom",type:"number"},on:{blur:function(){t.margin_bottom=Number(t.margin_bottom)||0}},model:{value:t.margin_bottom,callback:function(e){t.margin_bottom=e},expression:"margin_bottom"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:"margin left（mm）"}},[i("b-form-input",{attrs:{placeholder:"margin left",type:"number"},on:{blur:function(){t.margin_left=Number(t.margin_left)||0}},model:{value:t.margin_left,callback:function(e){t.margin_left=e},expression:"margin_left"}})],1)],1),i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:"margin right（mm）"}},[i("b-form-input",{attrs:{placeholder:"margin right",type:"number"},on:{blur:function(){t.margin_right=Number(t.margin_right)||0}},model:{value:t.margin_right,callback:function(e){t.margin_right=e},expression:"margin_right"}})],1)],1),"user-library-card"===t.route_type?i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("Customized_text")}},[i("b-form-input",{attrs:{placeholder:t.$t("Customized_text")},model:{value:t.customized_text,callback:function(e){t.customized_text=e},expression:"customized_text"}})],1)],1):t._e(),"user-library-card"===t.route_type?i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("School_seal")}},[i("b-form-file",{ref:"school_seal",attrs:{id:"school-seal",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here...","file-name-formatter":t.formatNames},on:{change:function(e){return t.uploadFile(e,"school_seal_file")}},model:{value:t.school_seal_file,callback:function(e){t.school_seal_file=e},expression:"school_seal_file"}})],1)],1):t._e(),"user-library-card"===t.route_type?i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("background_image")}},[i("b-form-file",{ref:"background_image",attrs:{id:"background-image",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here...","file-name-formatter":t.formatNames},on:{change:function(e){return t.uploadFile(e,"background_image")}},model:{value:t.background_image,callback:function(e){t.background_image=e},expression:"background_image"}})],1)],1):t._e(),t.libraryCardInfo?i("b-col",{attrs:{md:"2"}},[i("b-form-group",{attrs:{label:t.$t("reader_manage.reader_library_card_print.Insert_blank_data")}},[i("b-form-input",{attrs:{type:"number"},on:{blur:t.insertBlankData},model:{value:t.blankDataNum,callback:function(e){t.blankDataNum=e},expression:"blankDataNum"}})],1)],1):t._e(),i("b-col",{attrs:{md:"2"}},[i("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],attrs:{variant:"primary"},on:{click:t.showModalPrint}},[t._v(t._s("user-library-card"===t.route_type?t.$t("reader_manage.reader_library_card_print.Customized_borrowing_card_style"):t.$t("reader_manage.reader_library_card_print.Customized_reader_barcode_style")))])],1)],1),i("div",{staticStyle:{"overflow-x":"auto"}},[t.libraryCardInfo?i("div",{style:{width:t.paperWidth+"mm"},attrs:{id:"labelprinting"}},t._l(t.getPageSize,(function(e,n){return i("div",{key:n,style:t.cssVars},[t._l(t.row_array,(function(e,o){return i("div",{key:o,staticClass:"label_row"},t._l(t.column_array,(function(o,r){return i("div",{key:r,staticClass:"label_column",style:{background:"#fff url("+(t.studentInfo[n*t.row*t.column+e*t.column+o]&&t.studentInfo[n*t.row*t.column+e*t.column+o].background_image)+") no-repeat center 100%/cover"}},[t.studentInfo[n*t.row*t.column+e*t.column+o]?i("div",{staticStyle:{width:"100%",height:"100%",position:"relative"}},t._l(t.libraryCardInfo,(function(r,a){return i("div",{key:a,staticStyle:{"user-select":"none",position:"absolute","text-align":"center"},style:r.style},[-1!==r.id.indexOf("school_seal")?i("img",{staticStyle:{width:"100%"},attrs:{src:t.studentInfo[n*t.row*t.column+e*t.column+o].school_seal_file,alt:""}}):t._e(),-1!==r.id.indexOf("c_school_name")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].school_chinese_name||""))]):-1!==r.id.indexOf("e_school_name")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].school_english_name||""))]):-1!==r.id.indexOf("c_student_name")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].chinese_name||""))]):-1!==r.id.indexOf("e_student_name")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].english_name||""))]):-1!==r.id.indexOf("student_barcode")?i("vue-barcode",{attrs:{format:"CODE128",width:6,displayValue:!1,value:t.studentInfo[n*t.row*t.column+e*t.column+o].username}}):-1!==r.id.indexOf("student_ID")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].class_number||""))]):-1!==r.id.indexOf("class")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].class_name||""))]):-1!==r.id.indexOf("customized_text")?i("span",[t._v(t._s(t.studentInfo[n*t.row*t.column+e*t.column+o].customized_text||""))]):t._e()],1)})),0):t._e()])})),0)})),i("div",{staticClass:"page-break"})],2)})),0):i("p",{staticStyle:{"text-align":"center",margin:"32px 0",color:"#ff9f43"}},[t._v(" 「 "+t._s(t.$t("reader_manage.reader_library_card_print.Please_select_the_style_of_the_library_card_first"))+" 」 ")])]),i("b-row",{staticStyle:{"margin-top":"10px"}},[i("b-col",[i("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"mr-1",attrs:{type:"submit",variant:"primary"},on:{click:t.printLabel}},[t._v(" "+t._s(t.$t("Print"))+" ")])],1)],1)],1)],1)],1),i("b-modal",{ref:"modal-print",attrs:{id:"modal-xl","no-close-on-backdrop":"",size:"xl","hide-footer":"","hide-header-close":!0}},[i("b-row",[i("b-col",{attrs:{md:"12"}},[i("b-card",{staticStyle:{"overflow-x":"auto"},attrs:{title:"user-library-card"===t.route_type?t.$t("reader_manage.reader_library_card.patron_library_card"):t.$t("reader_manage.reader_library_card.Reading_barcode")}},[i("div",{staticStyle:{display:"flex","flex-wrap":"wrap",width:"300mm","justify-content":"center",margin:"0 auto"}},t._l(t.libraryCardTempalte,(function(e,n){return i("div",{key:n,staticStyle:{"margin-right":"20px","margin-bottom":"20px"}},[i("div",{staticClass:"card-list",staticStyle:{width:"105mm",height:"59mm",position:"relative","background-color":"#fff",border:"1px solid #ccc"}},t._l(e,(function(e,n){return i("div",{key:n,staticStyle:{"user-select":"none",cursor:"move",position:"absolute",border:"1px solid #ccc","text-align":"center"},style:e.style,attrs:{id:e.id}},[t._v(" "+t._s(e.content)+" ")])})),0),i("div",{staticStyle:{"text-align":"center"}},[i("b-form-radio",{attrs:{name:"card",value:n,plain:""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[t._v(t._s(t.$t("reader_manage.reader_library_card_print.system_setting"))+t._s(n+1)+" ")])],1)])})),0),i("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[i("b-form-radio",{attrs:{name:"card",value:4,plain:""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[t._v(t._s(t.$t("reader_manage.reader_library_card_print.Selected_settings"))+" ")])],1)])],1),i("b-col",{staticClass:"text-right",attrs:{md:"12"}},[i("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.closeModalPrint}},[t._v(t._s(t.$t("cancel")))]),i("b-button",{staticClass:"ml-2 px-5",attrs:{variant:"primary",size:"sm"},on:{click:t.confirmStyle}},[t._v(t._s(t.$t("confirm")))])],1)],1)],1),i("b-modal",{ref:"modal-setting-card",attrs:{id:"modal-xl","no-close-on-backdrop":"","hide-footer":"","hide-header-close":!0}},[i("b-col",{staticClass:"mb-2",attrs:{cols:"12"}},[i("div",{staticStyle:{position:"relative","background-color":"#fff",border:"1px solid #ccc",margin:"0 auto"},style:{width:t.width+"mm",height:t.height+"mm"},attrs:{id:"root"}},t._l(t.originalLibraryCard,(function(e,n){return i("div",{key:n,staticStyle:{"user-select":"none",cursor:"move",position:"absolute",border:"1px solid #ccc","text-align":"center"},style:e.style,attrs:{id:e.id}},[t._v(" "+t._s(e.content)+" ")])})),0)]),i("b-col",{staticClass:"text-right",attrs:{md:"12"}},[i("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.closeModalSettingCard}},[t._v(t._s(t.$t("cancel")))]),i("b-button",{staticClass:"ml-2 px-5",attrs:{variant:"primary",size:"sm"},on:{click:function(e){return t.confirmCustomStyle()}}},[t._v(t._s(t.$t("confirm")))])],1)],1)],1)},o=[],r=i("c7eb"),a=i("1da1"),l=i("2909"),m=(i("99af"),i("a630"),i("d81d"),i("b0c0"),i("e9c4"),i("a9e3"),i("b64b"),i("d3b7"),i("3ca3"),i("1913"),i("ddb0"),i("7be8")),s=(i("7898"),i("a15b7")),d=i("b28b"),c=i("1947"),p=i("205f"),h=i("8226"),u=i("9e14"),f=i("c43f"),_=i("4797"),g=i("9c7d"),b=i("e009"),y=i("f579"),x=i.n(y),w=i("7b1d"),v=i.n(w),S=[[{id:"school_seal1",content:"校章圖片",style:{width:"18mm",height:"18mm",left:"13px",top:"8px",fontSize:"12px"}},{id:"c_school_name1",content:"中文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"6mm",fontSize:"12px"}},{id:"e_school_name1",content:"英文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"12mm",fontSize:"12px"}},{id:"c_student_name1",content:"中文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"256px",top:"80px",fontSize:"12px"}},{id:"e_student_name1",content:"英文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"256px",top:"102px",fontSize:"12px"}},{id:"student_barcode1",content:"讀者條碼",style:{width:"40mm",height:"10mm",left:"238px",top:"124px",fontSize:"12px"}},{id:"student_ID1",content:"學號",style:{"min-width":"10mm","min-height":"5mm",left:"351px",top:"173px",fontSize:"12px"}},{id:"class1",content:"班級",style:{"min-width":"10mm","min-height":"5mm",left:"238px",top:"173px",fontSize:"12px"}},{id:"customized_text1",content:"自訂文字",style:{"min-width":"40mm","min-height":"5mm",left:"238px",top:"196px",fontSize:"12px"}}],[{id:"school_seal2",content:"校章圖片",style:{width:"18mm",height:"18mm",left:"13px",top:"8px",fontSize:"12px"}},{id:"c_school_name2",content:"中文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"6mm",fontSize:"12px"}},{id:"e_school_name2",content:"英文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"12mm",fontSize:"12px"}},{id:"c_student_name2",content:"中文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"30px",top:"79px",fontSize:"12px"}},{id:"e_student_name2",content:"英文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"30px",top:"101px",fontSize:"12px"}},{id:"student_barcode2",content:"讀者條碼",style:{width:"40mm",height:"10mm",left:"9px",top:"123px",fontSize:"12px"}},{id:"student_ID2",content:"學號",style:{"min-width":"10mm","min-height":"5mm",left:"127px",top:"173px",fontSize:"12px"}},{id:"class2",content:"班級",style:{"min-width":"10mm","min-height":"5mm",left:"13px",top:"171px",fontSize:"12px"}},{id:"customized_text2",content:"自訂文字",style:{"min-width":"40mm","min-height":"5mm",left:"13px",top:"196px",fontSize:"12px"}}],[{id:"school_seal3",content:"校章圖片",style:{width:"18mm",height:"18mm",left:"13px",top:"8px",fontSize:"12px"}},{id:"c_school_name3",content:"中文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"6mm",fontSize:"12px"}},{id:"e_school_name3",content:"英文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"12mm",fontSize:"12px"}},{id:"c_student_name3",content:"中文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"244px",top:"100px",fontSize:"12px"}},{id:"e_student_name3",content:"英文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"244px",top:"123px",fontSize:"12px"}},{id:"student_barcode3",content:"讀者條碼",style:{width:"40mm",height:"10mm",left:"228px",top:"180px",fontSize:"12px"}},{id:"student_ID3",content:"學號",style:{"min-width":"10mm","min-height":"5mm",left:"341px",top:"158px",fontSize:"12px"}},{id:"class3",content:"班級",style:{"min-width":"10mm","min-height":"5mm",left:"228px",top:"158px",fontSize:"12px"}},{id:"customized_text3",content:"自訂文字",style:{"min-width":"40mm","min-height":"5mm",left:"227px",top:"78px",fontSize:"12px"}}],[{id:"school_seal4",content:"校章圖片",style:{width:"18mm",height:"18mm",left:"13px",top:"8px",fontSize:"12px"}},{id:"c_school_name4",content:"中文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"6mm",fontSize:"12px"}},{id:"e_school_name4",content:"英文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"12mm",fontSize:"12px"}},{id:"c_student_name4",content:"中文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"33px",top:"103px",fontSize:"12px"}},{id:"e_student_name4",content:"英文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"33px",top:"125px",fontSize:"12px"}},{id:"student_barcode4",content:"讀者條碼",style:{width:"40mm",height:"10mm",left:"15px",top:"180px",fontSize:"12px"}},{id:"student_ID4",content:"學號",style:{"min-width":"10mm","min-height":"5mm",left:"127px",top:"158px",fontSize:"12px"}},{id:"class4",content:"班級",style:{"min-width":"10mm","min-height":"5mm",left:"15px",top:"158px",fontSize:"12px"}},{id:"customized_text4",content:"自訂文字",style:{"min-width":"40mm","min-height":"5mm",left:"14px",top:"82px",fontSize:"12px"}}]],z=S,k=[{id:"school_seal",content:"校章圖片",style:{width:"18mm",height:"18mm",left:"13px",top:"8px",fontSize:"12px"}},{id:"c_school_name",content:"中文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"6mm",fontSize:"12px"}},{id:"e_school_name",content:"英文校名",style:{"min-width":"25mm","min-height":"5mm",left:"24mm",top:"12mm",fontSize:"12px"}},{id:"c_student_name",content:"中文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"256px",top:"80px",fontSize:"12px"}},{id:"e_student_name",content:"英文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"256px",top:"102px",fontSize:"12px"}},{id:"student_barcode",content:"讀者條碼",style:{width:"40mm",height:"10mm",left:"238px",top:"124px",fontSize:"12px"}},{id:"student_ID",content:"學號",style:{"min-width":"10mm","min-height":"5mm",left:"351px",top:"173px",fontSize:"12px"}},{id:"class",content:"班級",style:{"min-width":"10mm","min-height":"5mm",left:"238px",top:"173px",fontSize:"12px"}},{id:"customized_text",content:"自訂文字",style:{"min-width":"40mm","min-height":"5mm",left:"238px",top:"196px",fontSize:"12px"}}],I=k,C=[{id:"c_student_name",content:"中文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"5px",top:"46px",fontSize:"12px"}},{id:"e_student_name",content:"英文學生姓名",style:{"min-width":"30mm","min-height":"5mm",left:"5px",top:"77px",fontSize:"12px"}},{id:"student_barcode",content:"讀者條碼",style:{width:"40mm",height:"8mm",left:"23px",top:"4px",fontSize:"12px"}},{id:"student_ID",content:"學號",style:{"min-width":"10mm","min-height":"5mm",left:"142px",top:"77px",fontSize:"12px"}},{id:"class",content:"班級",style:{"min-width":"10mm","min-height":"5mm",left:"143px",top:"46px",fontSize:"12px"}}],$=C,N={components:{GridLayout:m["GridLayout"],GridItem:m["GridItem"],BRow:s["a"],BCol:d["a"],BButton:c["a"],BCard:p["a"],VueBarcode:x.a,BFormGroup:h["a"],BFormRadio:u["a"],BFormFile:f["a"],BFormInput:_["a"],BFormTextarea:g["a"]},directives:{Ripple:b["a"],print:v.a},data:function(){return{layout:[],colNum:12,index:0,eventLog:[],row:5,column:2,margin_top:0,margin_bottom:0,margin_left:0,margin_right:0,paperWidth:210,paperHeight:297,width:105,height:59,row_array:null,column_array:null,fontsize:"10px",studentInfo:null,originalStudentInfo:null,libraryCardInfo:null,selected:"",originalLibraryCard:null,selectedDom:null,libraryCardTempalte:null,customized_text:null,school_seal_file:null,background_image:null,blankDataNum:0,indexed_db:null,route_type:null}},computed:{cssVars:function(){return{"--background-color":"#eee","--label-width":(Math.floor((this.paperWidth-this.margin_left-this.margin_right)/this.column)<this.width?Math.floor((this.paperWidth-this.margin_left-this.margin_right)/this.column):this.width)+"mm","--label-height":(Math.floor((this.paperHeight-this.margin_top-this.margin_bottom)/this.row)<this.height?Math.floor((this.paperHeight-this.margin_top-this.margin_bottom)/this.row):this.height)+"mm","padding-top":this.margin_top+"mm","padding-bottom":this.margin_bottom+"mm","padding-left":this.margin_left+"mm","padding-right":this.margin_right+"mm","--label-fontsize":this.fontsize,height:this.paperHeight+"mm"}},getPage:function(){var t=this;return function(e){for(var i=[],n=0;n<e;n++)0!==i.length?(n-i[i.length-1]+1)*t.height+Number(t.margin_top)+Number(t.margin_bottom)>t.paperHeight&&i.push(n):(n+1)*t.height+Number(t.margin_top)+Number(t.margin_bottom)>t.paperHeight&&i.push(n);return i}},getPageSize:function(){return this.row&&this.column?Math.ceil(this.studentInfo.length/(this.row*this.column)):0}},watch:{row:function(t,e){this.row_array=this.row?Object(l["a"])(Array(Number(this.row)).keys()):[]},column:function(t,e){this.column_array=this.column?Object(l["a"])(Array(Number(this.column)).keys()):[]},customized_text:function(t,e){var i=this;this.studentInfo.map((function(t,e){i.$set(i.studentInfo[e],"customized_text",i.customized_text)}))}},created:function(){var t=this;this.route_type=this.$route.query.route_type,this.studentInfo=JSON.parse(JSON.stringify(this.$store.getters["label/currentLabels"])),this.studentInfo.map((function(e,i){t.$set(t.studentInfo[i],"customized_text",""),t.$set(t.studentInfo[i],"school_seal_file",null),t.$set(t.studentInfo[i],"background_image",null)})),this.row_array=Array.from(Array(this.row).keys()),this.column_array=Array.from(Array(this.column).keys()),this.originalStudentInfo=JSON.parse(JSON.stringify(this.studentInfo))},mounted:function(){var t=this;"user-library-card"===this.route_type?(this.libraryCardTempalte=z,this.originalLibraryCard=JSON.parse(JSON.stringify(I))):(this.originalLibraryCard=JSON.parse(JSON.stringify($)),this.width=52,this.height=29,this.row=10,this.column=4);var e=window.indexedDB.open("userLibraryCard",1);e.onupgradeneeded=function(e){t.indexed_db=e.target.result,t.indexed_db.objectStoreNames.contains("libraryCard")||t.indexed_db.createObjectStore("libraryCard",{keyPath:"id"})},e.onsuccess=function(e){console.log(e.target.result),t.indexed_db=e.target.result}},methods:{messageShown:function(t,e,i){this.$swal({title:t,html:e,icon:i,customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},showModalPrint:function(){this.$refs["modal-print"].show()},confirmStyle:function(){var t=this;4===this.selected?(this.$refs["modal-setting-card"].show(),this.$nextTick((function(){var e=!1,i=document.getElementById("root");t.originalLibraryCard.map((function(n,o){var r=document.getElementById(n.id);r.onmousedown=function(n){if(n.stopPropagation(),t.selectedDom=o,1!==n.button&&2!==n.button){n=n||window.event;var a=n.pageX-r.offsetLeft,l=n.pageY-r.offsetTop;i.onmousemove=function(t){e=!0,t=t||window.event;var n=t.pageX-a,o=t.pageY-l;n<0?r.style.left="0px":n+r.offsetWidth+2>i.offsetWidth?r.style.left=i.offsetWidth-r.offsetWidth-2+"px":r.style.left=n+"px",o<0?r.style.top="0px":o+r.offsetHeight>i.offsetHeight?r.style.top=i.offsetHeight-r.offsetHeight+"px":r.style.top=o+"px"},document.onmouseup=function(n){n=n||window.event;var r=0,m=0,s=n.pageX-a-r,d=n.pageY-l-m;e&&(t.$set(t.originalLibraryCard[o].style,"left",s+"px"),t.$set(t.originalLibraryCard[o].style,"top",d+"px")),e=!1,i.onmousemove=null}}},document.onkeydown=function(e){e=e||window.event;var i=document.getElementById(t.originalLibraryCard[t.selectedDom].id);switch(e.keyCode){case 37:t.$set(t.originalLibraryCard[t.selectedDom].style,"left",i.offsetLeft-1+"px");break;case 38:t.$set(t.originalLibraryCard[t.selectedDom].style,"top",i.offsetTop-1+"px");break;case 39:t.$set(t.originalLibraryCard[t.selectedDom].style,"left",i.offsetLeft+1+"px");break;case 40:t.$set(t.originalLibraryCard[t.selectedDom].style,"top",i.offsetTop+1+"px");break}}}))}))):(document.onkeydown=null,this.libraryCardInfo=JSON.parse(JSON.stringify(this.libraryCardTempalte[this.selected])),this.$refs["modal-print"].hide())},closeModalPrint:function(){document.onkeydown=null,this.$refs["modal-print"].hide()},closeModalSettingCard:function(){document.onkeydown=null,this.$refs["modal-setting-card"].hide()},confirmCustomStyle:function(t){document.onkeydown=null,this.libraryCardInfo=JSON.parse(JSON.stringify(t||this.originalLibraryCard)),this.$refs["modal-print"].hide(),this.$refs["modal-setting-card"].hide()},printLabel:function(){this.updateIndexedDBItem(this.studentInfo),localStorage.setItem("libraryCardInfo",JSON.stringify(this.libraryCardInfo));var t="";t="?row="+this.row+"&column="+this.column+"&label_width="+this.width+"&label_height="+this.height+"&paper_width="+this.paperWidth+"&paper_height="+this.paperHeight+"&fontsize="+this.fontsize+"&margin_right="+this.margin_right+"&margin_bottom="+this.margin_bottom+"&margin_top="+this.margin_top+"&margin_left="+this.margin_left+"&row_array_length="+this.row_array.length;var e=document.createElement("a");e.href="../../libraryCardPrint.html"+t,e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)},formatNames:function(t){return 1===t.length?t[0].name:"".concat(t.length," files selected")},createBase64Image:function(t,e){var i=this,n=new FileReader;n.onload=function(t){i.studentInfo.map((function(n,o){i.$set(i.studentInfo[o],e,null),i.$set(i.studentInfo[o],e,t.target.result)}))},n.readAsDataURL(t)},uploadFile:function(t,e){var i=this;return Object(a["a"])(Object(r["a"])().mark((function n(){var o;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=t.target.files[0],i.createBase64Image(o,e);case 2:case"end":return n.stop()}}),n)})))()},addIndexedDBItem:function(t){var e=this.indexed_db.transaction(["libraryCard"],"readwrite").objectStore("libraryCard").add({id:1,libraryCard:t});e.onsuccess=function(t){console.log("數據寫入成功")},e.onerror=function(t){console.log("數據寫入失敗")}},readIndexedDBItem:function(){var t=this.indexed_db.transaction(["libraryCard"]),e=t.objectStore("libraryCard"),i=e.get(1);i.onerror=function(t){console.log("事務失敗")},i.onsuccess=function(t){i.result?(console.log("Name: "+i.result.name),console.log("Age: "+i.result.age),console.log("Email: "+i.result.email)):console.log("未獲得數據記錄")}},updateIndexedDBItem:function(t){var e=this.indexed_db.transaction(["libraryCard"],"readwrite").objectStore("libraryCard").put({id:1,libraryCard:t});e.onsuccess=function(t){console.log("數據更新成功")},e.onerror=function(t){console.log("數據更新失敗")}},removeIndexedDBItem:function(){var t=this.indexed_db.transaction(["person"],"readwrite").objectStore("person").delete(1);t.onsuccess=function(t){console.log("數據刪除成功")}},insertBlankData:function(){if(this.blankDataNum){for(var t=[],e=0;e<this.blankDataNum;e++)t.push({background_image:null,balance:0,borrow_stop_end_date:null,borrow_stop_start_date:null,chinese_name:"",class_name:"",class_number:"",cover:null,customized_text:"",effective_library_group:null,email:null,english_name:"",id:"",pre_borrow_stop_end_date:null,pre_borrow_stop_start_date:null,school_chinese_name:"",school_english_name:"",school_seal_file:null,status:1,tier:"",username:""});var i=JSON.parse(JSON.stringify(this.originalStudentInfo));this.studentInfo=[].concat(t,Object(l["a"])(i))}}}},O=N,D=(i("f9f2"),i("2877")),B=Object(D["a"])(O,n,o,!1,null,null,null);e["default"]=B.exports},f9f2:function(t,e,i){"use strict";i("6e09")}}]);