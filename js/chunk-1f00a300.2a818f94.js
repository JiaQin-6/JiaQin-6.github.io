(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f00a300"],{"05c3":function(e,t,a){e.exports=a.p+"img/E-Resources-cover5.5faf4857.jpeg"},"1fd2":function(e,t,a){e.exports=a.p+"img/E-Resources-cover11.1beedc45.jpeg"},"23f9":function(e,t,a){e.exports=a.p+"img/E-Resources-cover10.75e40637.jpeg"},"2c8c":function(e,t,a){e.exports=a.p+"img/E-Resources-cover12.652ce025.jpeg"},4388:function(e,t,a){e.exports=a.p+"img/E-Resources-cover8.167624a1.jpeg"},"46c0":function(e,t,a){e.exports=a.p+"img/E-Resources-cover4.b9888cdc.jpeg"},4701:function(e,t,a){e.exports=a.p+"img/E-Resources-cover13.1b5e9a75.jpeg"},"49eb":function(e,t,a){e.exports=a.p+"img/E-Resources-cover1.3edbf06f.jpeg"},"579c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-row",[r("b-col",{attrs:{md:"12"}},[r("b-card",[r("p",[e._v(" "+e._s(e.$route.query.id?e.$t("opac.New_electronic_resources_added.New_electronic_resources_edit"):e.$t("nav.opac.New_electronic_resources_added"))+" ")]),r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("basic_information"))+" ")]),r("b-row",[r("b-col",{staticClass:"mb-1",attrs:{md:"6"}},[r("p",[e._v(e._s(e.$t("resource_name")))]),r("b-form-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),r("b-col",{staticClass:"mb-1",attrs:{md:"6"}},[r("p",[e._v(e._s(e.$t("language")))]),r("v-select",{attrs:{dir:e.$store.state.appConfig.isRTL?"rtl":"ltr",options:e.languages,reduce:function(e){return e.id}},model:{value:e.formData.language,callback:function(t){e.$set(e.formData,"language",t)},expression:"formData.language"}})],1),r("b-col",{staticClass:"mb-1",attrs:{md:"6"}},[r("p",[e._v(e._s(e.$t("author")))]),r("b-form-input",{model:{value:e.formData.author,callback:function(t){e.$set(e.formData,"author",t)},expression:"formData.author"}})],1),r("b-col",{staticClass:"mb-1",attrs:{md:"6"}},[r("p",[e._v(e._s(e.$t("subject")))]),r("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"","allow-create":"","default-first-option":"",placeholder:"","popper-append-to-body":""},model:{value:e.formData.subject,callback:function(t){e.$set(e.formData,"subject",t)},expression:"formData.subject"}},e._l(e.subjects,(function(e){return r("el-option",{key:e.id,attrs:{label:e.label,value:e.label}})})),1)],1),r("b-col",{staticClass:"mb-1",attrs:{md:"12"}},[r("p",[e._v(" "+e._s(e.$t("Keywords_multiple_keywords_can_be_separated_by_commas"))+" ")]),r("b-form-input",{model:{value:e.formData.keyword,callback:function(t){e.$set(e.formData,"keyword",t)},expression:"formData.keyword"}})],1),r("b-col",{staticClass:"mb-1",attrs:{md:"12"}},[r("p",[e._v(e._s(e.$t("introduction")))]),r("b-form-textarea",{staticStyle:{height:"150px"},model:{value:e.formData.intro,callback:function(t){e.$set(e.formData,"intro",t)},expression:"formData.intro"}})],1)],1),r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("cover"))+" ")]),r("b-row",{staticClass:"mb-1"},[r("b-col",{attrs:{md:"3"}},[r("b-form-file",{ref:"upload-banner",attrs:{id:"upload-banner",accept:".jpg, .png, .gif",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here...","file-name-formatter":e.formatNames},on:{change:function(t){return e.uploadNewFile("cover",t)}},model:{value:e.formData.cover.file,callback:function(t){e.$set(e.formData.cover,"file",t)},expression:"formData.cover.file"}}),r("img",{directives:[{name:"show",rawName:"v-show",value:e.formData.cover.path,expression:"formData.cover.path"}],staticStyle:{"margin-top":"10px",border:"1px solid #ccc",padding:"10px",width:"115px"},attrs:{src:e.formData.cover.path,alt:""}})],1),r("b-col",[r("p",{staticStyle:{margin:"0 0 10px 0"}},[e._v(e._s(e.$t("Preset")))]),r("ul",{staticStyle:{display:"flex","flex-wrap":"wrap",padding:"0"}},e._l(12,(function(t,o){return r("li",{key:o,staticStyle:{"list-style":"none","margin-right":"10px","margin-bottom":"10px",border:"1px solid #ccc",padding:"10px",cursor:"pointer"},on:{click:function(t){e.selectCoverImage(a("eeca")("./E-Resources-cover"+(o+1)+".jpeg"),"E-Resources-cover"+(o+1))}}},[r("img",{attrs:{src:a("eeca")("./E-Resources-cover"+(o+1)+".jpeg"),alt:""}})])})),0)])],1),r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("File_upload"))+" ")]),r("b-row",{staticClass:"mb-1"},[r("b-col",{attrs:{md:"6"}},[r("b-form-file",{attrs:{placeholder:e.$t("select_file"),accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.html,.epub,.mobo,.jpg,.png,.jpeg,.gif,.bmp,.mov,.map3,.mp4,.rmvb,.mpg,.flv,.swf,.zip,.rar,.7z,.chm,.lit,.wdl,.ceb,.cebx,.abm,.pdg","drop-placeholder":e.$t("select_file")},on:{change:function(t){return e.uploadNewFile("archive",t)}},model:{value:e.archive_file,callback:function(t){e.archive_file=t},expression:"archive_file"}})],1),r("b-col",{attrs:{md:"6"}},[r("span",{staticStyle:{"line-height":"45px"}},[e._v(e._s(e.$t("Support_upload_size"))+"：100mb")])]),r("b-col",{attrs:{md:"12"}},e._l(e.formData.archive,(function(t,a){return r("div",{key:a,staticStyle:{display:"flex","justify-content":"space-between",padding:"10px"}},[r("span",[e._v(e._s(t.file&&t.file.name||t.path.split("/").pop()))]),r("span",{staticStyle:{cursor:"pointer",color:"var(--danger)"},on:{click:function(r){return e.clearFile(t.code,"archive",a)}}},[e._v(e._s(e.$t("Delete")))])])})),0)],1),r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("Attachment_upload"))+" ")]),r("b-row",{staticClass:"mb-1",staticStyle:{"align-items":"top"}},[r("b-col",[r("v-select",{attrs:{options:e.filetypes,reduce:function(e){return e.id}},on:{input:function(t){e.attach_url="",e.attach_file=null}},model:{value:e.attach_type,callback:function(t){e.attach_type=t},expression:"attach_type"}})],1),1===e.attach_type?r("b-col",[r("b-form-input",{attrs:{id:"webpage",type:"text",placeholder:e.$t("weburl")},model:{value:e.attach_url,callback:function(t){e.attach_url=t},expression:"attach_url"}})],1):e._e(),1!==e.attach_type?r("b-col",[r("b-form-file",{attrs:{disabled:!e.attach_type,placeholder:e.$t("select_file"),accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.html,.epub,.mobo,.jpg,.png,.jpeg,.gif,.bmp,.mov,.map3,.mp4,.rmvb,.mpg,.flv,.swf,.zip,.rar,.7z,.chm,.lit,.wdl,.ceb,.cebx,.abm,.pdg","drop-placeholder":e.$t("select_file")},model:{value:e.attach_file,callback:function(t){e.attach_file=t},expression:"attach_file"}}),r("span",{staticStyle:{"font-size":"12px",color:"var(--warning)"}},[e._v(e._s(e.$t("Support_upload_size"))+"：100mb")])],1):e._e(),r("b-col",[r("b-button",{attrs:{disabled:!(e.attach_type&&(1===e.attach_type?e.attach_url:e.attach_file))},on:{click:function(){e.attach_type&&(1===e.attach_type?e.attach_url:e.attach_file)&&e.uploadNewFile("attach")}}},[e._v(e._s(e.$t("Add")))])],1),r("b-col",{attrs:{md:"12"}},e._l(e.formData.attach,(function(t,a){return r("div",{key:a,staticStyle:{display:"flex","justify-content":"space-between",padding:"10px"}},[r("span",[e._v(e._s(e.filetypes.filter((function(e){return t.type==e.id}))[0].label))]),t.web_url?r("span",[e._v(e._s(t.web_url))]):e._e(),r("span",[e._v(e._s(t.file&&t.file.name||t.path&&t.path.split("/").pop()))]),r("span",{staticStyle:{cursor:"pointer",color:"var(--danger)"},on:{click:function(r){return e.clearFile(t.code,"attach",a)}}},[e._v(e._s(e.$t("Delete")))])])})),0)],1),r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("opac.New_electronic_resources_added.Designated_Readers"))+" ")]),r("b-row",{staticClass:"mb-1"},[r("b-col",{attrs:{md:"6"}},[r("p",[e._v(e._s(e.$t("Select_Group"))+"（"+e._s(e.$t("Multiple_Choices_Available"))+"）")]),r("v-select",{attrs:{options:e.group_lists,reduce:function(e){return e.id},multiple:""},on:{input:e.selectGroupLists},model:{value:e.formData.designated_readers,callback:function(t){e.$set(e.formData,"designated_readers",t)},expression:"formData.designated_readers"}})],1)],1),r("b-button",{attrs:{variant:"primary"},on:{click:e.addElectronicResources}},[e._v(e._s(e.$route.query.id?e.$t("save"):e.$t("Sending_out")))])],1)],1)],1)],1)},o=[],c=a("c7eb"),s=a("1da1"),n=(a("a4d3"),a("e01a"),a("a15b"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("d3b7"),a("159b"),a("6aac")),l=a("1eba"),i=a("0bd8"),u=a("2a2e"),p=a("6cf6"),d=a("0809"),f=a("a247"),m=a("2768"),b=a("29a1"),g=a("8361"),h=a("11de"),_=a("205f"),v=a("d247"),w=a("e8a3"),y=a("d6e4"),x=a("8226"),D=a("4797"),j=a("9c7d"),k=a("a15b7"),$=a("b28b"),R=a("1947"),S=a("c3e6"),E=a("c43f"),O=a("4a7a"),B=a.n(O),C=(a("e009"),a("cc6f"),{components:{BModal:n["a"],vSelect:B.a,BTableSimple:l["a"],BThead:i["a"],BTr:u["a"],BTh:p["a"],BTd:d["a"],BTbody:f["a"],BTfoot:m["a"],BTable:b["a"],BFormSelect:g["a"],BForm:h["a"],BCard:_["a"],BListGroupItem:v["a"],BAvatar:w["a"],BCardText:y["a"],BFormGroup:x["a"],BFormInput:D["a"],BFormTextarea:j["a"],BRow:k["a"],BCol:$["a"],BButton:R["a"],BFormCheckbox:S["a"],BFormFile:E["a"]},data:function(){return{formData:{name:null,language:null,author:null,subject:null,keyword:null,intro:null,cover:{file:null,code:null,path:null},archive:[],attach:[],designated_readers:[]},archive_file:[],attach_type:null,attach_url:null,attach_file:null,languages:[],group_lists:[],subjects:[],filetypes:[{id:1,label:"Web Page"},{id:2,label:"Picture"},{id:3,label:"Movie"},{id:4,label:"Sound"},{id:5,label:"Other"},{id:6,label:"Cover"},{id:7,label:"Catalog"}]}},created:function(){this.getLangugaes(),this.getSubjects(),this.getGroups(),this.$route.query.id&&this.getResourceById(this.$route.query.id)},methods:{getSubjects:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){var a,r,o,s;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/subject/");case 2:a=t.sent,200==a.status?(r=[],a.data.data.forEach((function(e,t){r.push({id:e.id,label:e.name})})),e.subjects=r):(o=a.errors.errors,s=e.alertMessage(o),e.messageShown(e.$t("error"),s,"error"));case 4:case"end":return t.stop()}}),t)})))()},formatNames:function(e){return 1===e.length?e[0].name:"".concat(e.length," files selected")},uploadNewFile:function(e,t){var a=this;return Object(s["a"])(Object(c["a"])().mark((function r(){return Object(c["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:"cover"===e?(a.formData[e].file=t.target.files[0],a.uploadCover(e)):"archive"===e?(a.formData[e].push({file:t.target.files[0],code:null,path:null}),a.archive_file=[],a.uploadFile(e,a.formData[e].length-1)):"attach"===e&&(a.formData[e].push({type:a.attach_type,file:a.attach_file,web_url:a.attach_url,code:null,path:null}),a.attach_type=null,a.attach_url=null,a.uploadFile(e,a.formData[e].length-1),a.attach_file=null);case 1:case"end":return r.stop()}}),r)})))()},getLangugaes:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){var a,r,o,s;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/utilities/?query_type=language");case 2:a=t.sent,200==a.status?(r=[],a.data.data.forEach((function(e,t){r.push({id:e.id,label:e.description})})),e.languages=r):(o=a.errors.errors,s=e.alertMessage(o),e.messageShown(e.$t("error"),s,"error"));case 4:case"end":return t.stop()}}),t)})))()},getGroups:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){var a,r,o,s;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/library_groups/");case 2:a=t.sent,200==a.status?(r=[],a.data.data.forEach((function(e,t){r.push({id:e.id,label:e.name})})),r.unshift({id:"all",label:e.$t("All")}),e.group_lists=r):(o=a.errors.errors,s=e.alertMessage(o),e.messageShown(e.$t("error"),s,"error"));case 4:case"end":return t.stop()}}),t)})))()},addElectronicResources:function(){var e=this;return Object(s["a"])(Object(c["a"])().mark((function t(){var a,r,o,s,n,l,i,u;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.formData.designated_readers.length&&("all"===e.formData.designated_readers[0]?(r=[],e.group_lists.map((function(e){r.push(e.id)})),a=r.join(",")):a=e.formData.designated_readers.join(",")),o=[],e.formData.archive.map((function(e){o.push(e.code)})),s=[],e.formData.attach.map((function(e){s.push({code:e.code})})),n={name:e.formData.name,lang:e.formData.language,author:e.formData.author,subject:e.formData.subject,keyword:e.formData.keyword,intro:e.formData.intro,group_types:a,cover_file:[e.formData.cover.code],archive_file:o,attach_file:s},t.prev=6,l=null,!e.$route.query.id){t.next=14;break}return t.next=11,e.putRequest("/electronic_resources/".concat(e.$route.query.id,"/"),n);case 11:l=t.sent,t.next=17;break;case 14:return t.next=16,e.postRequest("/electronic_resources/",n);case 16:l=t.sent;case 17:200==l.status?(e.messageShown(e.$t("success"),e.$route.query.id?e.$t("successfully_edit"):e.$t("Successfully_added"),"success"),e.formData={name:null,language:null,author:null,subject:null,keyword:null,intro:null,cover:{file:null,code:null,path:null},archive:[],attach:[],designated_readers:[]},e.$route.query.id&&e.$router.push({path:1==e.$route.query.source?"/opac/electronic-resource-approval":"/opac/my-resources"})):(i=l.errors.errors,u=e.alertMessage(i),e.messageShown(e.$t("error"),u,"error")),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](6),console.log(t.t0);case 23:case"end":return t.stop()}}),t,null,[[6,20]])})))()},messageShown:function(e,t,a){this.$swal({title:e,html:t,icon:a,customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},selectGroupLists:function(){-1!==this.formData.designated_readers.indexOf("all")&&(this.formData.designated_readers=["all"])},selectCoverImage:function(e,t){var a=this;fetch(location.origin+e,{method:"GET"}).then((function(e){return e.blob()})).then((function(e){var r=new File([e],t,{type:"image/jpeg"});a.formData.cover.file=r,a.uploadCover("cover")}))},uploadCover:function(e){var t=this;return Object(s["a"])(Object(c["a"])().mark((function a(){var r,o,s,n;return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.formData[e].file){a.next=2;break}return a.abrupt("return");case 2:return r=new FormData,r.append("type","electronic_resources"),r.append("file",t.formData[e].file),r.append("type_big",e),a.next=8,t.postRequest("/upload/upload_file/",r);case 8:o=a.sent,200==o.status?(t.formData[e].code&&t.clearFile(t.formData[e].code),t.formData[e].code=o.data.data.code,t.formData[e].path=o.data.data.path):(s=o.errors.errors,n=t.alertMessage(s),t.messageShown(t.$t("error"),n,"error"));case 10:case"end":return a.stop()}}),a)})))()},uploadFile:function(e,t){var a=this;return Object(s["a"])(Object(c["a"])().mark((function r(){var o,s,n,l;return Object(c["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=new FormData,o.append("type","electronic_resources"),a.formData[e][t].file&&o.append("file",a.formData[e][t].file),o.append("type_big",e),"attach"===e&&(o.append("type_small",a.formData[e][t].type),o.append("web_url",a.formData[e][t].web_url)),r.next=7,a.postRequest("/upload/upload_file/",o);case 7:s=r.sent,200==s.status?(a.formData[e][t].code=s.data.data.code,a.formData[e][t].path=s.data.data.path):(n=s.errors.errors,l=a.alertMessage(n),a.messageShown(a.$t("error"),l,"error"));case 9:case"end":return r.stop()}}),r)})))()},getResourceById:function(e){var t=this;return Object(s["a"])(Object(c["a"])().mark((function a(){var r,o,s,n;return Object(c["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.getRequest("/electronic_resources/".concat(e,"/"));case 2:r=a.sent,200==r.status?(t.formData.name=r.data.data.name,t.formData.language=Number(r.data.data.lang),t.formData.author=r.data.data.author,t.formData.subject=r.data.data.subject,t.formData.keyword=r.data.data.keyword,t.formData.intro=r.data.data.intro,t.formData.intro=r.data.data.intro,r.data.data.cover_files&&0!==r.data.data.cover_files.length&&(t.formData.cover.path=r.data.data.cover_files[0].file_url,t.formData.cover.code=r.data.data.cover_files[0].file_code),r.data.data.archive_files&&0!==r.data.data.archive_files.length&&r.data.data.archive_files.map((function(e){t.formData.archive.push({file:null,code:e.file_code,path:e.file_url})})),r.data.data.attach_files&&0!==r.data.data.attach_files.length&&r.data.data.attach_files.map((function(e){t.formData.attach.push({file:null,type:e.file_small_type,web_url:e.remark,code:e.file_code,path:e.file_url})})),r.data.data.group_types&&(o=r.data.data.group_types.split(","),o.map((function(e){t.formData.designated_readers.push(Number(e))})))):(s=r.errors.errors,n=t.alertMessage(s),t.messageShown(t.$t("error"),n,"error"));case 4:case"end":return a.stop()}}),a)})))()},clearFile:function(e,t,a){var r=this;return Object(s["a"])(Object(c["a"])().mark((function o(){var s,n,l;return Object(c["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e){o.next=3;break}return r.formData[t].splice(a,1),o.abrupt("return");case 3:return o.next=5,r.postRequest("/upload/clear_file/",{code:e});case 5:s=o.sent,200==s.status?"archive"!==t&&"attach"!==t||r.formData[t].splice(a,1):(n=s.errors.errors,l=r.alertMessage(n),r.messageShown(r.$t("error"),l,"error"));case 7:case"end":return o.stop()}}),o)})))()}}}),F=C,q=(a("d555"),a("2877")),N=Object(q["a"])(F,r,o,!1,null,"9c11c196",null);t["default"]=N.exports},9642:function(e,t,a){e.exports=a.p+"img/E-Resources-cover6.d7c4fcea.jpeg"},a3378:function(e,t,a){e.exports=a.p+"img/E-Resources-cover3.16d989af.jpeg"},ac64:function(e,t,a){e.exports=a.p+"img/E-Resources-cover2.700cae7a.jpeg"},b011:function(e,t,a){e.exports=a.p+"img/E-Resources-cover7.a6f2861d.jpeg"},cc6f:function(e,t,a){"use strict";e.exports=["background","background-attachment","background-color","background-clip","-webkit-background-clip","background-image","background-position","background-position-x","background-position-y","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-style","border-bottom-width","border-color","border-style","border-width","border-top","border-top-color","border-top-style","border-top-width","border-radius","box-shadow","clear","cursor","float","margin","margin-top","margin-bottom","padding","padding-top","padding-bottom","transform-origin","transform","-webkit-transition","transition-delay","transition-duration","transition-property","transition-timing-function","text-align","text-align-last","text-shadow"]},d555:function(e,t,a){"use strict";a("e327")},e327:function(e,t,a){},eeca:function(e,t,a){var r={"./E-Resources-cover1.jpeg":"49eb","./E-Resources-cover10.jpeg":"23f9","./E-Resources-cover11.jpeg":"1fd2","./E-Resources-cover12.jpeg":"2c8c","./E-Resources-cover13.jpeg":"4701","./E-Resources-cover2.jpeg":"ac64","./E-Resources-cover3.jpeg":"a3378","./E-Resources-cover4.jpeg":"46c0","./E-Resources-cover5.jpeg":"05c3","./E-Resources-cover6.jpeg":"9642","./E-Resources-cover7.jpeg":"b011","./E-Resources-cover8.jpeg":"4388","./E-Resources-cover9.jpeg":"f3ac"};function o(e){var t=c(e);return a(t)}function c(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=c,e.exports=o,o.id="eeca"},f3ac:function(e,t,a){e.exports=a.p+"img/E-Resources-cover9.4b043ba3.jpeg"}}]);