(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d213a7a"],{ae33:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=this,a=e.$createElement,r=e._self._c||a;return r("div",[r("b-row",[r("b-col",{attrs:{md:"12"}},[r("b-card",[r("p",[e._v(e._s(e.$t("nav.opac.library_new_notice")))]),r("b-row",{staticStyle:{padding:"0 20px"}},[r("b-col",{attrs:{md:"2"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"primary"},on:{click:function(){e.isShow=!0}}},[e._v(" "+e._s(e.$t("add"))+" ")])],1)],1),r("b-row",{staticStyle:{padding:"0 20px","overflow-x":"auto"}},e._l(e.newNoticesList,(function(t,a){return r("b-col",{key:a,staticStyle:{display:"flex","border-bottom":"1px solid #ccc",padding:"5px 0","justify-content":"space-between","align-items":"center","min-width":"900px"},attrs:{md:"12"}},[r("div",{staticStyle:{display:"flex"}},[r("div",{staticStyle:{"margin-right":"20px"}},[r("img",{staticStyle:{"margin-bottom":"10px","object-fit":"cover"},attrs:{width:"100",height:"80",src:t.image_url,alt:""}})]),r("div",{staticStyle:{"margin-right":"20px"}},[r("p",[e._v(e._s(t.subject))]),r("p",[e._v(e._s(t.rick_text_truncate))])]),r("div",[r("p",[e._v(e._s(t.create_ts.split(" ")[0]))])])]),r("div",[r("b-row",[r("b-col",[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:" ",size:"sm"},on:{click:function(a){return e.byIdGetNewNotice(t.id)}}},[e._v(" "+e._s(e.$t("edit"))+" ")])],1)],1),r("b-row",[r("b-col",[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"danger",size:"sm"},on:{click:function(a){return e.deleteNewNotice(t.id)}}},[e._v(" "+e._s(e.$t("Delete"))+" ")])],1)],1)],1)])})),1)],1)],1)],1),e.isShow?r("div",{staticStyle:{position:"fixed",height:"100%",width:"100%",left:"0",top:"0","z-index":"1150","background-color":"rgba(0, 0, 0, 0.3)"}},[r("div",{staticClass:"pl-1 pr-1 pt-1 pb-1",staticStyle:{width:"100%",height:"100%",overflow:"auto",position:"relative"}},[r("div",{staticStyle:{"background-color":"#fff","pointer-events":"auto",outline:"0",padding:"20px 0"}},[r("b-col",{attrs:{md:"12"}},[r("div",{staticClass:"mb-2"},[r("p",[e._v(e._s(e.$t("nav.opac.library_new_notice")))])]),r("b-form-group",{attrs:{label:e.$t("theme"),"label-for":"subject","label-cols-md":"'8"}},[r("b-form-input",{staticClass:"mb-1",attrs:{id:"subject",size:"sm"},model:{value:e.formdata.subject,callback:function(t){e.$set(e.formdata,"subject",t)},expression:"formdata.subject"}})],1),r("b-form-group",{attrs:{label:e.$t("content"),"label-for":"rick_text","label-cols-md":"'8"}},[r("TinymceEditor",{staticStyle:{width:"100%"},attrs:{id:"rick_text",tMceId:"tMce"+e.getRamNumber(6),documentHtml:e.formdata.rick_text},on:{getHtml:function(t){e.formdata.rick_text=t}}})],1),r("b-form-group",{attrs:{label:"Image","label-for":"image","label-cols-md":"'4"}},[r("b-form-file",{ref:"image",attrs:{id:"image",accept:"image/*",placeholder:"Choose a file or drop it here...","drop-placeholder":"Drop file here...","file-name-formatter":e.formatNames},model:{value:e.formdata.image_file,callback:function(t){e.$set(e.formdata,"image_file",t)},expression:"formdata.image_file"}}),r("img",{staticStyle:{"margin-top":"20px","max-width":"100px","max-height":"100px"},attrs:{src:e.formdata.image_url,target:"_blank"}})],1)],1),r("b-col",{staticClass:"text-right",attrs:{md:"12"}},[r("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(){t.isShow=!1,e.formdata.subject=null,e.formdata.rick_text=null,e.formdata.image_url=null}}},[e._v(e._s(e.$t("cancel")))]),r("b-button",{staticClass:"ml-2 px-5",attrs:{variant:"primary",size:"sm"},on:{click:e.addNewNotice}},[e._v(e._s(e.$t("Submit")))])],1)],1)])]):e._e()],1)},s=[],i=a("c7eb"),n=a("1da1"),o=(a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("498a"),a("9b87")),c=a("6aac"),l=a("1eba"),d=a("0bd8"),u=a("2a2e"),m=a("6cf6"),b=a("0809"),p=a("a247"),f=a("2768"),g=a("29a1"),w=a("8361"),h=a("11de"),v=a("205f"),_=a("d247"),x=a("e8a3"),k=a("d6e4"),y=a("8226"),S=a("4797"),j=a("a15b7"),B=a("b28b"),N=a("1947"),$=a("c3e6"),C=a("c43f"),O=a("e6c7"),T=a("4a7a"),M=a.n(T),F=a("e009"),R={components:{BModal:c["a"],vSelect:M.a,BTableSimple:l["a"],BThead:d["a"],BTr:u["a"],BTh:m["a"],BTd:b["a"],BTbody:p["a"],BTfoot:f["a"],BTable:g["a"],BFormSelect:w["a"],BForm:h["a"],BCard:v["a"],BListGroupItem:_["a"],BAvatar:x["a"],BCardText:k["a"],BFormGroup:y["a"],BFormInput:S["a"],BRow:j["a"],BCol:B["a"],BButton:N["a"],BFormCheckbox:$["a"],BFormFile:C["a"],TinymceEditor:o["a"]},data:function(){return{newNoticesList:[],formdata:{id:null,subject:null,rick_text:null,image_file:null,image_url:null},isShow:!1}},directives:{"b-modal":O["a"],Ripple:F["a"]},created:function(){this.getNewMessage()},methods:{getNotiveContent:function(t){var e=t.replace(/<img[^>]*>/g,""),a=document.createElement("div");a.innerHTML=e;var r=a.innerText||a.textContent||"",s=r.trim().split("\n")[0].split("&nbsp;")[0].substring(0,20);return console.log(s),r.trim().length>20?s+"...":s},formatNames:function(t){return 1===t.length?t[0].name:"".concat(t.length," files selected")},getNewMessage:function(){var t=this;return Object(n["a"])(Object(i["a"])().mark((function e(){var a,r,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getRequest("/new_message/");case 2:a=e.sent,200==a.status?t.newNoticesList=a.data.data:(r=a.errors.errors,s=t.alertMessage(r),t.messageShown(t.$t("error"),s,"error"));case 4:case"end":return e.stop()}}),e)})))()},addNewNotice:function(){var t=this;return Object(n["a"])(Object(i["a"])().mark((function e(){var a,r,s,n,o;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new FormData,a.append("subject",t.formdata.subject),a.append("rick_text",t.formdata.rick_text),a.append("rick_text_truncate",t.getNotiveContent(t.formdata.rick_text)),a.append("image_url",t.formdata.image_file),t.formdata.id&&a.append("id",t.formdata.id),e.next=8,t.postRequest("/new_message/saveOrUpdate/",a);case 8:if(r=e.sent,200==r.status){for(s in t.getNewMessage(),t.messageShown(t.$t("success"),t.$t("Successfully_added"),"success"),t.formdata)t.formdata[s]=null;t.isShow=!1}else n=r.errors.errors,o=t.alertMessage(n),t.messageShown(t.$t("error"),o,"error");case 10:case"end":return e.stop()}}),e)})))()},byIdGetNewNotice:function(t){var e=this;return Object(n["a"])(Object(i["a"])().mark((function a(){var r,s,n;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.getRequest("/new_message/".concat(t,"/"));case 2:r=a.sent,200==r.status?(e.isShow=!0,e.formdata.id=r.data.data.id,e.formdata.subject=r.data.data.subject,e.formdata.rick_text=r.data.data.rick_text,e.formdata.image_url=r.data.data.image_url):(s=r.errors.errors,n=e.alertMessage(s),e.messageShown(e.$t("error"),n,"error"));case 4:case"end":return a.stop()}}),a)})))()},deleteNewNotice:function(t){var e=this;return Object(n["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$swal({title:"",text:"".concat(e.$t("Do_you_want_to_delete_this_item")),icon:"warning",showCancelButton:!0,confirmButtonText:e.$t("confirm"),cancelButtonText:e.$t("cancel"),customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-outline-danger ml-1"},buttonsStyling:!1}).then(function(){var a=Object(n["a"])(Object(i["a"])().mark((function a(r){var s,n,o;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r.value){a.next=5;break}return a.next=3,e.deleteRequest("/new_message/".concat(t));case 3:s=a.sent,200==s.status?(e.getNewMessage(),e.messageShown(e.$t("success"),e.$t("successfully_delete"),"success")):(n=s.errors.errors,o=e.alertMessage(n),e.messageShown(e.$t("error"),o,"error"));case 5:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}());case 1:case"end":return a.stop()}}),a)})))()},messageShown:function(t,e,a){this.$swal({title:t,html:e,icon:a,customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},getRamNumber:function(t){for(var e="",a=0;a<t;a++)e+=Math.floor(36*Math.random()).toString(36);return e.toUpperCase()}}},z=R,I=a("2877"),L=Object(I["a"])(z,r,s,!1,null,null,null);e["default"]=L.exports}}]);