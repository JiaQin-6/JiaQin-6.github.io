(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20974e"],{a8ab:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",{attrs:{lg:"12"}},[a("b-card",[a("b-row",[a("b-col",{attrs:{md:"3"}},[a("p",[t._v(" "+t._s(t.$t("opac.system_email.OPAC_system_email_template_revision"))+" ")]),a("p",{staticStyle:{"margin-left":"30px","font-size":"18px"}},[t._v(" "+t._s(t.$t("opac.system_email.Select_email_template"))+" ")]),t._l([{title:t.$t("opac.system_email.overdue_notification_template"),value:"00"},{title:t.$t("opac.system_email.Advance_borrowing_notification_template"),value:"01"}],(function(e,r){return a("b-form-radio",{key:r,staticStyle:{margin:"20px 30px","font-size":"18px",display:"flex"},attrs:{name:"status",value:e.value,plain:"",size:"18"},model:{value:t.formData.report_source,callback:function(e){t.$set(t.formData,"report_source",e)},expression:"formData.report_source"}},[t._v(t._s(e.title)+" ")])})),a("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"deepblue",size:"sm",disabled:!t.formData.report_source},on:{click:function(){t.isShow=!0,t.getEmailTemplate()}}},[a("feather-icon",{attrs:{icon:"CheckIcon",size:"14"}}),t._v(" "+t._s(t.$t("change"))+" ")],1)],2)],1)],1)],1)],1),t.isShow?a("div",{staticStyle:{position:"fixed",height:"100%",width:"100%",left:"0",top:"0","z-index":"1150","background-color":"rgba(0, 0, 0, 0.3)"}},[a("div",{staticClass:"pl-1 pr-1 pt-1 pb-1",staticStyle:{width:"100%",height:"100%",overflow:"auto",position:"relative"}},[a("div",{staticStyle:{"background-color":"#fff","pointer-events":"auto",outline:"0",padding:"20px"}},[a("b-overlay",{attrs:{show:t.loading,rounded:"sm"}},[a("div",[a("p",[t._v(" "+t._s(t.$t("opac.system_email.Reading_report_notification_template"))+" ")]),a("b-row",[a("b-col",{attrs:{cols:"5"}},[a("b-form-group",{attrs:{label:t.$t("Main_idea")}},[a("b-form-input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1)],1),a("b-col",{attrs:{cols:"5"}},[a("b-form-group",{attrs:{label:t.$t("opac.system_email.Deactivate_display")+"   "+t.$t("opac.system_email.Enable_prompt")}},[a("b-form-checkbox",{attrs:{type:"switch"},model:{value:t.formData.flag,callback:function(e){t.$set(t.formData,"flag",e)},expression:"formData.flag"}})],1)],1)],1),a("b-row",[a("b-col",{attrs:{cols:"12",lg:"8"}},[a("b-form-group",{attrs:{label:t.$t("content"),"label-for":"rick_text","label-cols-md":"'8"}},[a("TinymceEditor",{staticStyle:{width:"100%"},attrs:{id:"rick_text",tMceId:"tMce"+t.getRamNumber(6),documentHtml:t.formData.rick_text,keyword:t.keyword},on:{getHtml:function(e){t.formData.rick_text=e},resetKeyword:function(e){t.keyword=null}}})],1)],1),a("b-col",{attrs:{cols:"12",lg:"4"}},[a("ul",{staticStyle:{border:"1px solid #ccc",padding:"32px"}},t._l([{title:t.$t("read_name"),value:"VAR_ENAME"},{title:t.$t("bookName"),value:"VAR_BOOK"},{title:t.$t("Borrowing_date"),value:"VAR_BORROW"},{title:t.$t("Expiration_date"),value:"VAR_DUEDATE"}],(function(e,r){return a("li",{key:r,staticStyle:{"list-style":"none",padding:"10px","background-color":"var(--blue)",cursor:"pointer",color:"#fff","margin-bottom":"10px","text-align":"center"},on:{click:function(a){t.keyword=e.value}}},[t._v(" "+t._s(e.title)+" ")])})),0)])],1),a("b-row",[a("b-col",{staticStyle:{display:"flex","justify-content":"end"}},[a("div",{staticStyle:{"margin-right":"10px"}},[a("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:""},on:{click:function(){t.isShow=!1}}},[t._v(" "+t._s(t.$t("cancel"))+" ")])],1),a("div",[a("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"primary"},on:{click:t.addTemplateCreateOrUpdate}},[t._v(" "+t._s(t.$t("confirm"))+" ")])],1)])],1)],1)])],1)])]):t._e()],1)},o=[],i=a("c7eb"),l=a("1da1"),s=a("ade3"),n=(a("a15b"),a("d81d"),a("d3b7"),a("25f0"),a("9b87")),c=a("11de"),m=a("8226"),p=a("4797"),d=a("9e14"),u=a("2924"),f=a("3b99"),b=a("1947"),_=a("a15b7"),v=a("b28b"),g=a("6190"),w=a("f902"),y=a("205f"),h=a("5fda"),x=a("e98b"),k=a("aa59"),D=a("3135"),B=a("d247"),$=a("d6e4"),S=a("c3e6"),O=a("9b03"),R=a("4a7a"),A=a.n(R),C=(a("223c"),a("a18c"),a("e009")),E={components:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({vSelect:A.a,BForm:c["a"],BFormGroup:m["a"],BFormInput:p["a"],BFormRadio:d["a"],BFormRadioGroup:u["a"],BFormCheckboxGroup:f["a"],BButton:b["a"],BRow:_["a"],BCol:v["a"],BTab:g["a"],BTabs:w["a"],BCard:y["a"],BAlert:h["a"],BBadge:x["a"],BLink:k["a"],BListGroup:D["a"],BListGroupItem:B["a"],BCardText:$["a"]},"BFormGroup",m["a"]),"BFormCheckbox",S["a"]),"TinymceEditor",n["a"]),"BOverlay",O["a"]),directives:{Ripple:C["a"]},data:function(){return{formData:{report_source:null,id:null,title:null,flag:null,rick_text:""},keyword:null,isShow:!1,loading:!1}},methods:{getEmailTemplate:function(){var t=this;return Object(l["a"])(Object(i["a"])().mark((function e(){var a,r,o;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.postRequest("/email/email_template/",{template_type:t.formData.report_source});case 2:a=e.sent,200==a.status?(t.formData.id=a.data.data.id,t.formData.title=a.data.data.template_name,t.formData.flag="Y"===a.data.data.template_enable,t.formData.rick_text=a.data.data.template_content):(r=a.errors.errors,o=t.alertMessage(r),t.messageShown(t.$t("error"),o,"error"));case 4:case"end":return e.stop()}}),e)})))()},addTemplateCreateOrUpdate:function(){var t=this;return Object(l["a"])(Object(i["a"])().mark((function e(){var a,r,o,l;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,a=[],["VAR_ENAME","VAR_BOOK","VAR_BORROW","VAR_DUEDATE"].map((function(e){-1!==t.formData.rick_text.indexOf(e)&&a.push(e)})),e.next=5,t.postRequest("/email/template_create_or_update/",{id:t.formData.id,template_type:t.formData.report_source,template_name:t.formData.title,template_content:t.formData.rick_text,template_enable:t.formData.flag?"Y":"N",keywords:a.join(",")});case 5:r=e.sent,200==r.status?(t.isShow=!1,t.loading=!1,t.formData.id?t.messageShown(t.$t("success"),t.$t("successfully_edit"),"success"):t.messageShown(t.$t("success"),t.$t("Successfully_added"),"success")):(t.loading=!1,o=r.errors.errors,l=t.alertMessage(o),t.messageShown(t.$t("error"),l,"error"));case 7:case"end":return e.stop()}}),e)})))()},messageShown:function(t,e,a){this.$swal({title:t,html:e,icon:a,customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},getRamNumber:function(t){for(var e="",a=0;a<t;a++)e+=Math.floor(36*Math.random()).toString(36);return e.toUpperCase()}},created:function(){}},j=E,T=a("2877"),M=Object(T["a"])(j,r,o,!1,null,null,null);e["default"]=M.exports}}]);