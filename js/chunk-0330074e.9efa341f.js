(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0330074e"],{"66be":function(e,t,s){e.exports=s.p+"img/book.573a5436.png"},c4bd:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-row",[r("b-col",{attrs:{lg:"3"}},[r("b-card",[r("p",[e._v(e._s(e.$t("nav.opac.Electronic_resource_approval")))]),r("b-col",{staticStyle:{"margin-top":"10px"},attrs:{md:"12"}},[r("p",[e._v(e._s(e.$t("resource_name")))]),r("b-form-input",{staticClass:"mb-1",attrs:{id:"priority",placeholder:e.$t("resource_name"),type:"text"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"primary"},on:{click:function(){e.listType="",e.getElectronicResourcesList()}}},[r("feather-icon",{attrs:{icon:"ChevronRightIcon",size:"14"}}),e._v(" "+e._s(e.$t("view"))+" ")],1)],1)],1)],1),r("b-col",{attrs:{lg:"9"}},[r("b-card",{staticStyle:{overflow:"hidden"}},[r("b-row",[r("b-col",{staticStyle:{display:"flex"}},[r("p",{staticStyle:{padding:"10px","border-radius":"5px","margin-right":"20px",cursor:"pointer"},style:{"background-color":"pe"===e.listType?"#ffb638":"",color:"pe"===e.listType?"#fff":""},on:{click:function(t){return e.selectListType("pe")}}},[e._v(" "+e._s(e.$t("opac.electronic_resource_approval.Pending_resources"))+" ")]),r("p",{staticStyle:{padding:"10px","border-radius":"5px","margin-right":"20px",cursor:"pointer"},style:{"background-color":"ao"===e.listType?"#ffb638":"",color:"ao"===e.listType?"#fff":""},on:{click:function(t){return e.selectListType("ao")}}},[e._v(" "+e._s(e.$t("opac.electronic_resource_approval.Joined_resource_enabled"))+" ")]),r("p",{staticStyle:{padding:"10px","border-radius":"5px",cursor:"pointer"},style:{"background-color":"ac"===e.listType?"#ffb638":"",color:"ac"===e.listType?"#fff":""},on:{click:function(t){return e.selectListType("ac")}}},[e._v(" "+e._s(e.$t("opac.electronic_resource_approval.Joined_resource_deactivated"))+" ")])]),r("b-col",{staticClass:"d-flex align-items-center justify-content-start mb-1 mb-md-0",attrs:{cols:"12",md:"3"}},[r("v-select",{staticStyle:{width:"100%"},attrs:{label:"Number of rows",options:e.sizeOptions,clearable:!1},model:{value:e.size,callback:function(t){e.size=t},expression:"size"}})],1)],1),r("b-row",["pe"===e.listType?r("b-col",{attrs:{md:"3"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"success",size:"sm"},on:{click:function(t){return e.approvalResource("01")}}},[r("feather-icon",{attrs:{icon:"CheckIcon",size:"14"}}),e._v(" "+e._s(e.$t("Batch_pass"))+" ")],1)],1):e._e(),"pe"===e.listType?r("b-col",{attrs:{md:"3"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"danger",size:"sm"},on:{click:function(t){return e.approvalResource("02")}}},[r("feather-icon",{attrs:{icon:"XIcon",size:"14"}}),e._v(" "+e._s(e.$t("Batch_returns"))+" ")],1)],1):e._e(),"ao"===e.listType?r("b-col",{attrs:{md:"3"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"danger",size:"sm"},on:{click:function(t){return e.updatesStartOrStop("N")}}},[r("feather-icon",{attrs:{icon:"CheckIcon",size:"14"}}),e._v(" "+e._s(e.$t("batch_deactivation"))+" ")],1)],1):e._e(),"ac"===e.listType?r("b-col",{attrs:{md:"3"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"mb-1",attrs:{block:"",variant:"success",size:"sm"},on:{click:function(t){return e.updatesStartOrStop("Y")}}},[r("feather-icon",{attrs:{icon:"CheckIcon",size:"14"}}),e._v(" "+e._s(e.$t("batch_activation"))+" ")],1)],1):e._e()],1),r("b-table",{attrs:{items:e.resourceList,responsive:"",fields:e.tableColumns,"primary-key":"id","show-empty":"","empty-text":"No matching records found"},scopedSlots:e._u([{key:"cell(select)",fn:function(t){return[r("b-form-checkbox",{attrs:{value:!0},model:{value:t.item.select,callback:function(s){e.$set(t.item,"select",s)},expression:"data.item.select"}})]}},{key:"cell(resource)",fn:function(t){return[r("div",{staticStyle:{display:"flex"}},[r("div",{staticStyle:{width:"100px","margin-right":"10px"}},[t.item.cover_files[0]&&t.item.cover_files[0].file_url?r("img",{staticStyle:{width:"100%"},attrs:{src:t.item.cover_files[0]&&t.item.cover_files[0].file_url,alt:""}}):r("div",{staticStyle:{position:"relative"}},[r("p",{staticClass:"content_3",staticStyle:{width:"55%","font-size":"12px",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}},[e._v(" "+e._s(t.item.name)+" ")]),r("img",{staticStyle:{"max-width":"100%","max-height":"100%","object-fit":"cover",margin:"0 auto"},attrs:{src:s("66be"),alt:""}})])]),r("div",{staticStyle:{flex:"1"}},[r("p",{staticStyle:{margin:"0"}},[e._v(e._s(t.item.name))]),r("p",{staticStyle:{margin:"0"}},[e._v(" "+e._s(e.$t("author"))+": "+e._s(t.item.author)+" ")]),r("p",{staticStyle:{margin:"0"}},[e._v(" "+e._s(e.$t("category"))+": "+e._s(t.item.subject)+" ")]),r("p",{staticStyle:{margin:"0"}},[e._v("ACNOï¼š"+e._s(t.item.acno))])])])]}},"pe"!==e.listType?{key:"cell(number)",fn:function(t){return e._l(t.item.archive_files,(function(t,s){return r("p",{key:s},[e._v(" "+e._s(t.down_count)+" ")])}))}}:null,{key:"cell(file)",fn:function(t){return e._l(t.item.archive_files,(function(t,s){return r("p",{key:s,staticStyle:{width:"250px"}},[e._v(" "+e._s(t.file_url.split("/").pop())+" ")])}))}},{key:"cell(size)",fn:function(t){return e._l(t.item.archive_files,(function(t,s){return r("p",{key:s},[e._v(" "+e._s(t.file_size)+" ")])}))}},{key:"cell(opera)",fn:function(t){return[r("b-row",[r("b-col",[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],attrs:{block:"",variant:"primary",size:"sm"},on:{click:function(s){return e.previewSource(t)}}},[r("feather-icon",{attrs:{icon:"SeeIcon",size:"14"}}),e._v(" "+e._s(e.$t("preview"))+" ")],1),r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],attrs:{block:"",variant:"d",size:"sm"},on:{click:function(s){return e.editResource(t.item.id)}}},[r("feather-icon",{attrs:{icon:"EditIcon",size:"14"}}),e._v(" "+e._s(e.$t("edit"))+" ")],1)],1),r("b-col",[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],attrs:{block:"",variant:"success",size:"sm"},on:{click:function(s){return e.approvalResource("01",t.item.id)}}},[r("feather-icon",{attrs:{icon:"CheckIcon",size:"14"}}),e._v(" "+e._s(e.$t("pass"))+" ")],1),r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],attrs:{block:"",variant:"danger",size:"sm"},on:{click:function(s){return e.approvalResource("02",t.item.id)}}},[r("feather-icon",{attrs:{icon:"XIcon",size:"14"}}),r("span",[e._v(e._s(e.$t("returns")))])],1)],1)],1)]}}],null,!0)}),r("b-row",{staticStyle:{"margin-bottom":"10px","margin-top":"10px"}},[e.totalRows?r("b-col",{staticClass:"mt-1"},[e._v(" "+e._s(e.$t("A_total_of_totalRows_items").replace("{totalRows}",e.totalRows))+" , "+e._s(e.$t("Which_page").replace("{currentPage}",e.currentPage))+" ")]):e._e(),r("b-col",[r("b-pagination",{staticClass:"my-0",attrs:{"total-rows":e.totalRows,"per-page":e.size,"first-number":"","last-number":"","prev-class":"prev-item","next-class":"next-item",align:"right",size:"md"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)],1)],1)],1)],1),e.previewItem?r("b-modal",{ref:"my-modal",attrs:{id:"modal-xl",size:"lg","no-close-on-backdrop":"","hide-footer":"","hide-header-close":!0}},[r("div",{staticClass:"mb-2"},[r("p",[e._v(e._s(e.$t("Resource_preview")))])]),r("b-col",{attrs:{md:"12"}},[r("div",{staticClass:"mb-1"},[r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("basic_information"))+" ")]),r("b-row",{staticStyle:{padding:"0 20px"}},[r("b-col",{attrs:{md:"12"}},[r("span",{staticClass:"mr-1"},[e._v(e._s(e.$t("resource_name"))+":")]),r("span",[e._v(e._s(e.previewItem.name))])]),r("b-col",{attrs:{md:"12"}},[r("span",{staticClass:"mr-1"},[e._v(e._s(e.$t("author"))+":")]),r("span",[e._v(e._s(e.previewItem.author))])]),r("b-col",{attrs:{md:"12"}},[r("span",{staticClass:"mr-1"},[e._v(e._s(e.$t("category"))+":")]),r("span",[e._v(e._s(e.previewItem.subject))])]),r("b-col",{attrs:{md:"12"}},[r("span",{staticClass:"mr-1"},[e._v(e._s(e.$t("Keywords"))+":")]),r("span",[e._v(e._s(e.previewItem.keyword))])]),r("b-col",{attrs:{md:"12"}},[r("span",{staticClass:"mr-1"},[e._v(e._s(e.$t("language"))+":")]),r("span",[e._v(e._s(e.languages.filter((function(t){return e.previewItem.lang==t.id}))[0].label))])]),r("b-col",{attrs:{md:"12"}},[r("span",{staticClass:"mr-1"},[e._v(e._s(e.$t("introduction"))+":")]),r("span",[e._v(e._s(e.previewItem.intro))])])],1)],1),r("div",{staticClass:"mb-1"},[r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("File_Cover"))+" ")]),r("b-row",{staticStyle:{padding:"0 20px"}},[r("b-col",[r("img",{attrs:{src:e.previewItem.cover_files[0]&&e.previewItem.cover_files[0].file_url,alt:""}})])],1)],1),r("div",{staticClass:"mb-1"},[r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("File_List"))+" ")]),r("b-row",{staticStyle:{padding:"0 20px"}},e._l(e.previewItem.archive_files,(function(t,s){return r("b-col",{key:s},[r("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.file_url))]),r("span",{staticStyle:{color:"#ffb638",cursor:"pointer"},on:{click:function(s){return e.downloadFile(t)}}},[r("feather-icon",{attrs:{icon:"DownloadIcon",size:"14"}}),e._v(e._s(e.$t("download")))],1)])})),1)],1),r("div",{staticClass:"mb-1"},[r("p",{staticStyle:{"background-color":"#f3f2f7",padding:"5px"}},[e._v(" "+e._s(e.$t("Attachment_List"))+" ")]),r("b-row",{staticStyle:{padding:"0 20px"}},e._l(e.previewItem.attach_files,(function(t,s){return r("b-col",{key:s,attrs:{md:"12"}},[r("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.file_url))]),r("span",{staticStyle:{color:"#ffb638",cursor:"pointer"},on:{click:function(s){return e.downloadFile(t)}}},[r("feather-icon",{attrs:{icon:"DownloadIcon",size:"14"}}),e._v(e._s(e.$t("download")))],1)])})),1)],1)]),r("b-col",{staticClass:"text-right",attrs:{md:"12"}},[r("b-button",{attrs:{variant:"primary"},on:{click:function(){e.$refs["my-modal"].hide()}}},[e._v(e._s(e.$t("confirm")))])],1)],1):e._e()],1)},a=[],i=s("c7eb"),o=s("1da1"),c=s("ade3"),n=(s("a4d3"),s("e01a"),s("a434"),s("b0c0"),s("d3b7"),s("3ca3"),s("159b"),s("ddb0"),s("2b3d"),s("bf19"),s("9861"),s("11de")),l=s("8226"),u=s("4797"),p=s("2924"),b=s("3b99"),d=s("1947"),m=s("a15b7"),f=s("b28b"),_=s("6190"),v=s("f902"),h=s("29a1"),g=s("205f"),w=s("5fda"),y=s("e98b"),k=s("aa59"),x=s("3135"),$=s("d247"),S=s("d6e4"),C=s("c3e6"),z=s("26d2"),R=s("4a7a"),L=s.n(R),O=(s("223c"),s("a18c"),s("e009")),j={components:Object(c["a"])(Object(c["a"])(Object(c["a"])({vSelect:L.a,BForm:n["a"],BFormGroup:l["a"],BFormInput:u["a"],BFormRadioGroup:p["a"],BFormCheckboxGroup:b["a"],BButton:d["a"],BRow:m["a"],BCol:f["a"],BTab:_["a"],BTabs:v["a"],BTable:h["a"],BCard:g["a"],BAlert:w["a"],BBadge:y["a"],BLink:k["a"],BListGroup:x["a"],BListGroupItem:$["a"],BCardText:S["a"]},"BFormGroup",l["a"]),"BFormCheckbox",C["a"]),"BPagination",z["a"]),directives:{Ripple:O["a"]},data:function(){return{languages:[],name:null,listType:"pe",resourceList:[],tableColumns:[{key:"select",label:this.$t("Select")},{key:"resource",label:this.$t("resource"),sortable:!0},{key:"upload_user.username",label:this.$t("uploader"),sortable:!0},{key:"create_ts",label:this.$t("Joining_date"),sortable:!0},{key:"file",label:this.$t("File"),sortable:!0},{key:"size",label:this.$t("size"),sortable:!0},{key:"opera",label:this.$t("Action")}],previewItem:null,currentPage:1,totalRows:null,sizeOptions:[100,200,500,1e3,this.$t("All")],size:100}},mounted:function(){this.getLangugaes(),this.getElectronicResourcesList()},watch:{currentPage:{handler:function(e,t){this.getElectronicResourcesList()}},size:{handler:function(e,t){this.size===this.$t("All")?(this.size=this.totalRows,this.getElectronicResourcesList()):this.size!==this.totalRows&&this.getElectronicResourcesList()}}},methods:{getElectronicResourcesList:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var s,r,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.postRequest("/electronic_resources/electronic_resources_list/",{button_type:e.listType,name:e.name,page:e.currentPage,size:e.size});case 2:s=t.sent,200==s.status?(e.resourceList=s.data.data,e.totalRows=s.data.meta.count,e.resourceList.forEach((function(e){e.select=null})),e.name&&0!==e.resourceList.length&&(e.listType="Y"===e.resourceList[0].enable?"ac":"01"===e.resourceList[0].review_status?"ao":"pe")):(r=s.errors.errors,a=e.alertMessage(r),e.messageShown(e.$t("error"),a,"error"));case 4:case"end":return t.stop()}}),t)})))()},selectListType:function(e){this.listType!==e&&(this.listType=e,this.resourceList=[],"pe"!==e&&"number"!==this.tableColumns[6].key?(this.tableColumns.splice(6,0,{key:"number",label:this.$t("amount_of_downloads"),sortable:!0}),this.tableColumns.pop()):"pe"===e&&"number"===this.tableColumns[6].key&&(this.tableColumns.splice(6,1),this.tableColumns.push({key:"opera",label:"action"})),this.getElectronicResourcesList())},messageShown:function(e,t,s){this.$swal({title:e,html:t,icon:s,customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})},getLangugaes:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var s,r,a,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRequest("/utilities/?query_type=language");case 2:s=t.sent,200==s.status?(r=[],s.data.data.forEach((function(e,t){r.push({id:e.id,label:e.description})})),e.languages=r):(a=s.errors.errors,o=e.alertMessage(a),e.messageShown(e.$t("error"),o,"error"));case 4:case"end":return t.stop()}}),t)})))()},previewSource:function(e){var t=this;this.previewItem=e.item,this.$nextTick((function(){t.$refs["my-modal"].show()}))},downloadFile:function(e){return Object(o["a"])(Object(i["a"])().mark((function t(){var s,r,a,o,c;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e.file_url,{method:"GET"});case 3:return s=t.sent,t.next=6,s.blob();case 6:r=t.sent,a=window.URL.createObjectURL(r),console.log(a),o=e.split("/").pop(),c=document.createElement("a"),c.style.display="none",c.href=a,c.download=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(a),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](0),console.log(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))()},approvalResource:function(e,t){var s=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,o,c,n;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=[],!t){r.next=5;break}a.push(t),r.next=9;break;case 5:if(s.resourceList.forEach((function(e){e.select&&a.push(e.id)})),0!==a.length){r.next=9;break}return s.messageShown(s.$t("error"),s.$t("opac.electronic_resource_approval.please_select_resource_first"),"error"),r.abrupt("return");case 9:return r.next=11,s.postRequest("/electronic_resources/update_er/",{ids:a,review_status:e});case 11:o=r.sent,200==o.status?(s.getElectronicResourcesList(),s.messageShown(s.$t("success"),s.$t("successfully_edit"),"success")):(c=o.errors.errors,n=s.alertMessage(c),s.messageShown(s.$t("error"),n,"error"));case 13:case"end":return r.stop()}}),r)})))()},updatesStartOrStop:function(e,t){var s=this;return Object(o["a"])(Object(i["a"])().mark((function r(){var a,o,c,n;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=[],!t){r.next=5;break}a.push(t),r.next=9;break;case 5:if(s.resourceList.forEach((function(e){e.select&&a.push(e.id)})),0!==a.length){r.next=9;break}return s.messageShown(s.$t("error"),s.$t("opac.electronic_resource_approval.please_select_resource_first"),"error"),r.abrupt("return");case 9:return r.next=11,s.postRequest("/electronic_resources/updates_start_stop/",{ids:a,type:e});case 11:o=r.sent,200==o.status?(s.getElectronicResourcesList(),s.messageShown(s.$t("success"),s.$t("successfully_edit"),"success")):(c=o.errors.errors,n=s.alertMessage(c),s.messageShown(s.$t("error"),n,"error"));case 13:case"end":return r.stop()}}),r)})))()},editResource:function(e){var t=this;return Object(o["a"])(Object(i["a"])().mark((function s(){return Object(i["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:t.$router.push({path:"/opac/new-electronic-resources-added",query:{id:e,source:1}});case 1:case"end":return s.stop()}}),s)})))()}}},T=j,B=s("2877"),I=Object(B["a"])(T,r,a,!1,null,null,null);t["default"]=I.exports}}]);