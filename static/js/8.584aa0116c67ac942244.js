webpackJsonp([8],{"5OPm":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Xxa5"),a=s.n(r),o=s("exGp"),n=s.n(o),i=s("Dd8w"),c=s.n(i),l=s("NYxO"),m={name:"formItem",props:{formdata:{require:!0,type:Object}},data:function(){return{form:{gender:"Gender",surname:"",givename:"",datebirth:"Date of birth",HKID_passport:"",HKID1:"",HKID2:"",title:this.formdata.title},select:1}},created:function(){console.log(this.formdata),this.getNemObj(),console.log(this.form)},methods:{inputHkid:function(){""!=this.$refs.HKID_passport.value.trim()?(this.$createToast({txt:this.$t("onlyOne"),time:3e3,type:"txt"}).show(),this.select=2):this.select=1},inputPassport:function(){""!=this.$refs.HKID1.value.trim()||""!=this.$refs.HKID2.value.trim()?(this.$createToast({txt:this.$t("onlyOne"),time:3e3,type:"txt"}).show(),this.select=1):this.select=2},getNemObj:function(){if(this.$store.state.userInfo){for(var e in console.log("当userInfo有值时,把值赋值给form"),this.formdata)this.form[e]=this.formdata[e];""!=this.form.HKID_passport&&(this.select=2)}},showDatePicker:function(){this.datePicker||(this.datePicker=this.$createDatePicker({title:this.$t("account_info_birthday"),min:new Date(1900,1,1),max:new Date,value:new Date(1980,5,20),cancelTxt:this.$t("cancel"),confirmTxt:this.$t("confirm"),onSelect:this.selectHandle,onCancel:this.cancelHandle})),this.datePicker.show()},selectHandle:function(e,t,s){this.form.datebirth=this.dateTozero(t).join("-"),console.log(this.form.datebirth)},cancelHandle:function(){},dateTozero:function(e){return e.map(function(e){return e<10?"0"+e:""+e})},showPicker:function(){var e=[{text:this.$t("Female"),value:"Male"},{text:this.$t("Male"),value:"Female"}];this.picker||(this.picker=this.$createPicker({title:this.$t("Gender"),data:[e],cancelTxt:this.$t("cancel"),confirmTxt:this.$t("confirm"),onSelect:this.selectGender,onCancel:this.cancelGender})),this.picker.show()},selectGender:function(e,t,s){this.form.gender=s.join(" "),console.log(this.form.gender)},cancelGender:function(){}},computed:{}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-wrap"},[s("p",{staticClass:"pTitle"},[s("span",{staticClass:"member"},[e._v("\n      "+e._s(e.$t("quote_member"))+"\n      "),s("span",{staticClass:"member-num"},[e._v(e._s(e.formdata.member))])]),e._v(" "),s("span",{staticClass:"member-title"},[e._v(e._s(e.formdata.title))])]),e._v(" "),s("div",{staticClass:"form-item"},[s("p",[e._v(e._s(e.$t("sex_title_1")))]),e._v(" "),s("div",{ref:"Gender",staticClass:"GenderDiv",class:{blank:"Gender"!=this.form.gender},on:{click:e.showPicker}},[e._v(e._s(this.form.gender))])]),e._v(" "),s("div",{staticClass:"form-item"},[s("p",[e._v(e._s(e.$t("account_info_lastname2")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.surname,expression:"form.surname"}],staticClass:"Gender",attrs:{type:"text",placeholder:"Surname"},domProps:{value:e.form.surname},on:{input:function(t){t.target.composing||e.$set(e.form,"surname",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-item"},[s("p",[e._v(e._s(e.$t("account_info_firstname2")))]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.givename,expression:"form.givename"}],staticClass:"Gender",attrs:{type:"text",placeholder:"Given Name"},domProps:{value:e.form.givename},on:{input:function(t){t.target.composing||e.$set(e.form,"givename",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"form-item"},[s("p",[e._v(e._s(e.$t("Date_of_Birth")))]),e._v(" "),s("div",{staticClass:"GenderDiv",class:{blank:"Date of birth"!=this.form.datebirth},on:{click:e.showDatePicker}},[e._v(e._s(this.form.datebirth))])]),e._v(" "),s("div",[s("button",{staticClass:"HKID",class:[1==e.select?"blue":""],on:{click:e.inputHkid}},[e._v("\n      "+e._s(e.$t("personal_hkid"))+"\n      "),s("i",{class:[1==e.select?"cubeic-ok":""]})]),e._v(" "),s("button",{staticClass:"passport",class:[2==e.select?"blue":""],on:{click:e.inputPassport}},[e._v("\n      "+e._s(e.$t("info_passport"))+"\n      "),s("i",{class:[2==e.select?"cubeic-ok":""]})])]),e._v(" "),s("div",{staticClass:"HK"},[s("span",{staticClass:"hkNumber"},[e._v(e._s(1==e.select?e.$t("account_info_hkid")+":":e.$t("info_passport")+":"))]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.select,expression:"select == 1"}],staticClass:"right"},[s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.HKID1,expression:"form.HKID1"}],ref:"HKID1",staticClass:"IDnumber",attrs:{type:"text",placeholder:"A123456"},domProps:{value:e.form.HKID1},on:{input:function(t){t.target.composing||e.$set(e.form,"HKID1",t.target.value)}}})]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.select,expression:"select == 1"}]},[e._v("(")]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.select,expression:"select == 1"}]},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.HKID2,expression:"form.HKID2"}],ref:"HKID2",staticClass:"num",attrs:{type:"text",placeholder:"7"},domProps:{value:e.form.HKID2},on:{input:function(t){t.target.composing||e.$set(e.form,"HKID2",t.target.value)}}})]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.select,expression:"select == 1"}]},[e._v(")")])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2==e.select,expression:"select == 2"}],staticClass:"right"},[s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.form.HKID_passport,expression:"form.HKID_passport"}],ref:"HKID_passport",staticClass:"IDnumber",class:[2==e.select?"width":""],attrs:{type:"text",placeholder:"A123456"},domProps:{value:e.form.HKID_passport},on:{input:function(t){t.target.composing||e.$set(e.form,"HKID_passport",t.target.value)}}})])])])])},staticRenderFns:[]};var f={components:{WFormItem:s("VU/8")(m,u,!1,function(e){s("EvFu")},"data-v-fb9e2972",null).exports},data:function(){return{formData:[],people:"",ages:""}},computed:c()({},Object(l.c)(["travelInfo","userInfo","userId","protectorInfo","ageInfo"])),created:function(){this.$createToast({time:1e3,txt:"loading..."}).show(),this.getFormData()},methods:c()({},Object(l.b)(["reset","setUserInfo","setProtectorInfo","setCertificateId"]),{confirm:function(){var e=this;return n()(a.a.mark(function t(){var s,r,o,n,i,c,l,m,u,f;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n in console.log(e.$refs.input0),s=e.travelInfo.count,r=0,o=[],s)if(s[n]>0)for(i=0;i<s[n];i++)c="input"+r,console.log(c),console.log(e.$refs[c][0].form),o.push(e.$refs[c][0].form),r++;console.log(o),i=0;case 7:if(!(i<o.length)){t.next=29;break}if(console.log(e.getYears(o[i].datebirth)),""!=o[i].datebirth&&""!=o[i].givename&&""!=o[i].gender&&""!=o[i].surname){t.next=12;break}return e.$createToast({txt:e.$t("insurance_toast"),time:3e3,type:"txt"}).show(),t.abrupt("return",!1);case 12:if(""!=o[i].HKID1||""!=o[i].HKID_passport){t.next=15;break}return e.$createToast({txt:e.$t("insurance_toast"),time:3e3,type:"txt"}).show(),t.abrupt("return",!1);case 15:if(""==o[i].HKID1||""!=o[i].HKID2){t.next=18;break}return e.$createToast({txt:e.$t("insurance_toast"),time:3e3,type:"txt"}).show(),t.abrupt("return",!1);case 18:if(!(e.getYears(o[i].datebirth)<e.ageInfo.min_age||e.getYears(o[i].datebirth)>e.ageInfo.max_age)){t.next=21;break}return e.$createToast({txt:"请输入正确年龄",time:3e3,type:"txt"}).show(),t.abrupt("return",!1);case 21:return t.next=23,e.verifyUserFrom(o[i]);case 23:if(0!=(l=t.sent)){t.next=26;break}return t.abrupt("return",!1);case 26:i++,t.next=7;break;case 29:console.log(l),1==l&&(console.log(o),e.setUserInfo(o),console.log(e.travelInfo.count.myself),e.getYears(o[0].datebirth),0==e.travelInfo.count.myself?(m="noMyself",e.setCertificateId(m),e.$router.push({path:"/Policyholder"})):e.getYears(o[0].datebirth)<18?(u="lessEighteen",e.setCertificateId(u),e.$router.push({path:"/Policyholder"})):(f=["protectorInfo"],e.reset(f),e.$router.push({path:"/confirmOrder"})));case 31:case"end":return t.stop()}},t,e)}))()},getFormData:function(){var e=1,t=0,s={child:this.$t("ship_child"),friends:this.$t("Family_friends"),myself:this.$t("ship_myself"),spouse:this.$t("ship_my_spouse")},r=this.travelInfo.count;for(var a in console.log(r),r)if(r[a]>0)for(var o=0;o<r[a];o++){if(this.userInfo)var n=this.userInfo[t].gender,i=this.userInfo[t].surname,c=this.userInfo[t].givename,l=this.userInfo[t].datebirth,m=this.userInfo[t].HKID1,u=this.userInfo[t].HKID2,f=this.userInfo[t].HKID_passport;t++,this.people++,this.formData.push({title:s[a],member:e++,gender:n||"",surname:i||"",givename:c||"",datebirth:l||"",HKID1:m||"",HKID2:u||"",HKID_passport:f||""})}console.log(this.formData)},verifyUserFrom:function(e){var t=this;return n()(a.a.mark(function s(){var r,o,n;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(r=!1,""==e.HKID1){s.next=19;break}return o=e.HKID1+e.HKID2,console.log(o),s.prev=4,s.next=7,t.$http.post("/wesupromo/web/validate/validateHKIDWithLng",{language:"tc",hkid:o});case 7:n=s.sent,console.log(n),console.log(n.status),s.next=19;break;case 12:if(s.prev=12,s.t0=s.catch(4),console.log(s.t0),0!=s.t0.data.is_valid){s.next=19;break}return t.$createToast({time:3500,type:"txt",txt:s.t0.msg}).show(),s.abrupt("return",!1);case 19:return r=!0,console.log(r),s.abrupt("return",r);case 22:case"end":return s.stop()}},s,t,[[4,12]])}))()},toPrePage:function(){this.$router.push("/Prompt")},getToday:function(e){var t=e.getFullYear(),s=e.getMonth()+1;s=s<10?"0"+s:s;var r=e.getDate();return t+"/"+s+"/"+(r=r<10?"0"+r:r)},getYears:function(e){var t=this.getToday(new Date),s=Math.ceil((new Date(t+" 00:00:00").getTime()-new Date(e.replace(/-/g,"/")+" 00:00:00").getTime())/864e5);return this.ages=Math.floor(s/365),console.log(this.ages+"岁"),this.ages}})},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-wrap"},[s("div",{staticClass:"headTitle"},[s("i",{staticClass:"cubeic-arrow",on:{click:e.toPrePage}}),e._v(" "),s("p",[e._v(e._s(e.$t("account_add_member")))])]),e._v(" "),e._l(e.formData,function(e,t){return s("WFormItem",{key:t,ref:"input"+t,refInFor:!0,attrs:{formdata:e}})}),e._v(" "),s("div",{staticClass:"button-bar"},[s("button",{staticClass:"proceed",on:{click:e.confirm}},[e._v(e._s(e.$t("confirm")))])])],2)},staticRenderFns:[]};var h=s("VU/8")(f,p,!1,function(e){s("Bp5h")},"data-v-110e41ac",null);t.default=h.exports},Bp5h:function(e,t){},EvFu:function(e,t){}});
//# sourceMappingURL=8.584aa0116c67ac942244.js.map