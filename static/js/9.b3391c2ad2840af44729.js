webpackJsonp([9],{"5igT":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),n=a("NYxO"),r=(a("S2MT"),{data:function(){return{date:{departureDate:(new Date).toISOString().slice(0,10).replace(/-/g,"/"),returnDate:"",departureDateObj:new Date,returnDateObj:new Date},count:{myself:0,spouse:0,child:0,friends:0},dateType:"",data:"",todayDate:"",isMore:"",loading:!1}},mounted:function(){var t=this,e={language:this.language,product_id:this.product_id,phone_country_code:this.areacode,merchant_id:this.MerchantId},a=this.$createToast({time:0,txt:this.$t("loading")});a.show(),this.$http.post("/wesupromo/web/tpc/getProductDetails",e).then(function(e){100==e.status&&(t.data=e.data,t.$nextTick(function(){a.hide()}))}).catch(function(e){e.msg?t.$createToast({txt:e.msg,time:3e3,type:"txt"}).show():t.$createToast({txt:t.$t("request_error_title"),time:3e3,type:"txt"}).show()})},created:function(){if(this.todayDate=this.getToday(new Date),this.date.departureDate=this.getToday(new Date),this.plan&&2==this.plan.period_type){var t=(new Date).toISOString().slice(0,10).split("-");this.date.returnDate=this.getreturnDate(t)}if(this.travelInfo&&this.travelInfo.count){for(var e in this.travelInfo.date)this.date[e]=this.travelInfo.date[e];for(var e in this.travelInfo.count)this.count[e]=this.travelInfo.count[e]}this.$createToast({time:1e3,txt:this.$t("loading")}).show()},methods:i()({},Object(n.b)(["setTravel","reset"]),{handlecount:function(t,e){"select"===t?this.count[e]=0===this.count[e]?1:0:"sub"===t&&this.count[e]>0?this.count[e]=this.count[e]-1:"add"===t&&(this.count[e]=this.count[e]+1)},showDatePicker:function(t){var e=this;if("returnDate"===t&&2==this.plan.period_type)return!1;this.dateType=t,this.datePicker||(this.datePicker=this.$createDatePicker({title:"Date Picker",min:new Date(2008,7,8),max:new Date(2050,9,20),value:new Date,cancelTxt:this.$t("cancel"),confirmTxt:this.$t("confirm"),onSelect:this.selectHandle,onCancel:this.cancelHandle,onChange:this.changeHandle})),this.datePicker.show(),setTimeout(function(){e.datePicker.$updateProps({title:"departureDate"===t?""+e.$t("products_departure_data"):""+e.$t("products_return_data"),value:"departureDate"===t?e.date.departureDateObj:e.date.returnDateObj})},0)},getreturnDate:function(t){var e;e=[(Number(t[0])+1).toString(),t[1],t[2]<10?"0"+t[2]:t[2]].join("/");var a=new Date(e+" 00:00:00").getTime()-1,s=(t=new Date(a)).getFullYear()+"/",i=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/",n=t.getDate()<10?"0"+t.getDate():t.getDate();return s+i+n},selectHandle:function(t,e,a){if(this.date[this.dateType]=this.dateTozero(e).join("/"),"departureDate"===this.dateType&&2==this.plan.period_type){var s=this.dateTozero(e);this.date.returnDate=this.getreturnDate(s)}this.date[this.dateType+"Obj"]=t,this.fromToday()},dateTozero:function(t){return t.map(function(t){return t<10?"0"+t:""+t})},cancelHandle:function(){},changeHandle:function(){navigator.vibrate(10)},showResults:function(){return this.date.returnDate?new Date(this.date.returnDate+" 00:00:00").getTime()<new Date(this.date.departureDate+" 00:00:00").getTime()?(this.$createToast({txt:this.$t("travel_annaul_toast"),time:3e3,type:"txt"}).show(),!1):new Date(this.date.departureDate+" 00:00:00").getTime()<new Date(this.todayDate+" 00:00:00").getTime()?(this.$createToast({txt:this.$t("travel_annaul_toast"),time:3e3,type:"txt"}).show(),!1):2==this.plan.period_type&&this.isMore>180?(this.$createToast({txt:this.$t("moreDays"),time:3e3,type:"txt"}).show(),!1):0===this.counts?(this.$createToast({txt:this.$t("insurance_toast"),time:3e3,type:"txt"}).show(),!1):this.counts>this.ageInfo.max_persons?(this.$createDialog({type:"alert",title:"",content:this.$t("minPeople")+this.ageInfo.max_persons,icon:"cubeic-alert"}).show(),!1):void(1==this.plan.period_type?this.checkDate():this.next()):(this.$createToast({txt:this.$t("insurance_toast"),time:3e3,type:"txt"}).show(),!1)},next:function(){this.loading=!0;var t={count:this.count,days:this.getDays,date:this.date,product_id:this.product_id,phone_country_code:this.areacode};if(this.travelInfo){var e=!1;for(var a in this.travelInfo.count)if(this.count[a]!=this.travelInfo.count[a]){e=!0;this.reset(["userInfo","protectorInfo"]);break}"true"==this.$route.query.isChange?1==e?(this.setTravel(t),this.$router.push({path:"/MemberData"})):(this.setTravel(t),this.$router.push({path:"/ConfirmOrder"})):(this.setTravel(t),this.$router.push({path:"/Infoconfirm"}))}else this.setTravel(t),this.$router.push({path:"/Infoconfirm"})},checkDate:function(){var t=this,e={product_id:this.plan.product_id,language:this.language,start_date:this.date.departureDate.replace(/\//g,"-"),end_date:this.date.returnDate.replace(/\//g,"-")};this.$http.post("/wesupromo/web/validate/checkJourneyDate",e).then(function(e){e.data.is_valid?t.next():(t.loading=!1,t.$createToast({txt:e.msg,time:3e3,type:"txt"}).show())})},getToday:function(t){var e=t.getFullYear(),a=t.getMonth()+1;a=a<10?"0"+a:a;var s=t.getDate();return e+"/"+a+"/"+(s=s<10?"0"+s:s)},fromToday:function(){this.isMore=Math.ceil((new Date(this.date.departureDate+" 00:00:00").getTime()-new Date(this.todayDate+" 00:00:00").getTime())/864e5)+1},toPreviousPage:function(){this.$router.push("/index/"+this.MerchantId+"/"+this.beginProductId+"/"+this.language)}}),computed:i()({},Object(n.c)(["areacode","plan","beginProductId","travelInfo","product_id","language","MerchantId","ageInfo","pricedata","userInfo"]),{counts:function(){return this.count.myself+this.count.spouse+this.count.child+this.count.friends},getDays:function(){var t=0;return this.date.returnDate&&new Date(this.date.returnDateObj).getTime()>=new Date(this.date.departureDate+" 00:00:00").getTime()&&(t=Math.ceil((new Date(this.date.returnDateObj).getTime()-new Date(this.date.departureDateObj))/864e5)+1),2==this.plan.period_type&&(t=Math.ceil((new Date(this.date.returnDate+" 23:59:59").getTime()-new Date(this.date.departureDate+" 00:00:00").getTime())/864e5)),t}})}),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page-wrap"},[s("div",{staticClass:"headTitle"},[s("i",{staticClass:"cubeic-arrow",on:{click:t.toPreviousPage}}),t._v(" "),s("p")]),t._v(" "),s("div",{staticClass:"header progressive"},[s("img",{directives:[{name:"progressive",rawName:"v-progressive",value:t.data.products_imgs[0],expression:"data.products_imgs[0]"}],staticClass:"banner",attrs:{src:a("S2MT"),alt:""}})]),t._v(" "),s("div",{staticClass:"container-wrap"},[s("p",{staticClass:"title"},[t._v(t._s(t.$t("pc_tra_title1")))]),t._v(" "),s("p",{staticClass:"part-title"},[s("span",[t._v(t._s(t.$t("departure_return")))]),t._v(" "),s("span",[t._v(t._s(t.getDays)+" "+t._s(t.$t("days")))])]),t._v(" "),s("div",{staticClass:"date-part"},[s("cube-button",{on:{click:function(e){return t.showDatePicker("departureDate")}}},[s("div",{staticClass:"date-pick"},[s("p",{staticClass:"date-label"},[t._v(t._s(t.$t("quote_departure_date")))]),t._v(" "),s("span",{class:{"date-value":!0,empty:!t.date.departureDate}},[t._v(t._s(t.date.departureDate?t.date.departureDate:"XXXX/XX/XX"))])])]),t._v(" "),s("cube-button",{on:{click:function(e){return t.showDatePicker("returnDate")}}},[s("div",{staticClass:"date-pick"},[s("p",{staticClass:"date-label"},[t._v(t._s(t.$t("quote_return_date")))]),t._v(" "),s("span",{class:{"date-value":!0,empty:!t.date.returnDate}},[t._v(t._s(t.date.returnDate?t.date.returnDate:"XXXX/XX/XX"))])])])],1),t._v(" "),s("p",{staticClass:"part-title"},[s("span",[t._v(t._s(t.$t("member_companion")))]),t._v(" "),s("span",[t._v(t._s(t.counts)+" "+t._s(t.$t("quote_members")))])]),t._v(" "),s("div",{staticClass:"Companion-part"},[s("div",{on:{click:function(e){return t.handlecount("select","myself")}}},[s("span",[t._v(t._s(t.$t("ship_myself")))]),t._v(" "),s("span",{class:{checkBox:!0,selected:0!==t.count.myself}})]),t._v(" "),s("div",{on:{click:function(e){return t.handlecount("select","spouse")}}},[s("span",[t._v(t._s(t.$t("ship_my_spouse")))]),t._v(" "),s("span",{class:{checkBox:!0,selected:0!==t.count.spouse}})]),t._v(" "),s("div",[s("span",[t._v("\n          "+t._s(t.$t("child"))+"\n          "),s("i",[t._v(t._s(t.$t("age_below")))])]),t._v(" "),s("span",[s("i",{staticClass:"action-button sub",on:{click:function(e){return t.handlecount("sub","child")}}}),t._v(" "),s("span",[t._v(t._s(t.count.child))]),t._v(" "),s("i",{staticClass:"action-button add",on:{click:function(e){return t.handlecount("add","child")}}})])]),t._v(" "),s("div",[s("span",[t._v(t._s(t.$t("Family_friends")))]),t._v(" "),s("span",[s("i",{staticClass:"action-button sub",on:{click:function(e){return t.handlecount("sub","friends")}}}),t._v(" "),s("span",[t._v(t._s(t.count.friends))]),t._v(" "),s("i",{staticClass:"action-button add",on:{click:function(e){return t.handlecount("add","friends")}}})])])]),t._v(" "),s("div",{staticClass:"button-bar"},[s("button",{staticClass:"next",on:{click:t.showResults}},[t._v(t._s(t.$t("product_show_my_results")))])])]),t._v(" "),s("cube-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]})],1)},staticRenderFns:[]};var c=a("VU/8")(r,o,!1,function(t){a("CA8G")},"data-v-fae0c484",null);e.default=c.exports},CA8G:function(t,e){}});