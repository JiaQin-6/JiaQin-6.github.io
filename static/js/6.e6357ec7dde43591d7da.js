webpackJsonp([6],{"5OPm":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),n=r("exGp"),i=r.n(n),o=r("Dd8w"),c=r.n(o),u=r("NYxO"),l={name:"formItem",props:{formdata:{require:!0,type:Object}},data:function(){return{form:{gender:"Gender",surname:"",givename:"",datebirth:"Date of birth",HKID_passport:"",HKID1:"",title:this.formdata.title},select:1}},created:function(){this.getNemObj()},methods:{inputHkid:function(){this.form.HKID_passport="",this.select=1},inputPassport:function(){this.form.HKID1="",this.select=2},getNemObj:function(){if(this.$store.state.userInfo){for(var t in this.formdata)this.form[t]=this.formdata[t];""!=this.form.HKID_passport&&(this.select=2)}},showDatePicker:function(){this.datePicker||(this.datePicker=this.$createDatePicker({title:this.$t("account_info_birthday"),min:new Date(1900,1,1),max:new Date,value:new Date(1980,5,20),cancelTxt:this.$t("cancel"),confirmTxt:this.$t("confirm"),onSelect:this.selectHandle,onCancel:this.cancelHandle})),this.datePicker.show()},selectHandle:function(t,e,r){this.form.datebirth=this.dateTozero(e).join("-")},cancelHandle:function(){},dateTozero:function(t){return t.map(function(t){return t<10?"0"+t:""+t})},showPicker:function(){var t=[{text:this.$t("Female"),value:"Male"},{text:this.$t("Male"),value:"Female"}];this.picker||(this.picker=this.$createPicker({title:this.$t("Gender"),data:[t],cancelTxt:this.$t("cancel"),confirmTxt:this.$t("confirm"),onSelect:this.selectGender,onCancel:this.cancelGender})),this.picker.show()},selectGender:function(t,e,r){this.form.gender=r.join(" ")},cancelGender:function(){}},computed:{}},m={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"form-wrap"},[r("p",{staticClass:"pTitle"},[r("span",{staticClass:"member"},[t._v("\n      "+t._s(t.$t("quote_member"))+"\n      "),r("span",{staticClass:"member-num"},[t._v(t._s(t.formdata.member))])]),t._v(" "),r("span",{staticClass:"member-title"},[t._v(t._s(t.formdata.title))])]),t._v(" "),r("div",{staticClass:"form-item"},[r("p",[t._v(t._s(t.$t("sex_title_1")))]),t._v(" "),r("div",{ref:"Gender",staticClass:"GenderDiv",class:{blank:"Gender"!=this.form.gender},on:{click:t.showPicker}},[t._v(t._s(this.form.gender))])]),t._v(" "),r("div",{staticClass:"form-item"},[r("p",[t._v(t._s(t.$t("account_info_lastname2")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.surname,expression:"form.surname"}],staticClass:"Gender",attrs:{type:"text",placeholder:"Surname"},domProps:{value:t.form.surname},on:{input:function(e){e.target.composing||t.$set(t.form,"surname",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-item"},[r("p",[t._v(t._s(t.$t("account_info_firstname2")))]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.givename,expression:"form.givename"}],staticClass:"Gender",attrs:{type:"text",placeholder:"Given Name"},domProps:{value:t.form.givename},on:{input:function(e){e.target.composing||t.$set(t.form,"givename",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-item"},[r("p",[t._v(t._s(t.$t("Date_of_Birth")))]),t._v(" "),r("div",{staticClass:"GenderDiv",class:{blank:"Date of birth"!=this.form.datebirth},on:{click:t.showDatePicker}},[t._v(t._s(this.form.datebirth))])]),t._v(" "),r("div",[r("button",{staticClass:"HKID",class:[1==t.select?"blue":""],on:{click:t.inputHkid}},[t._v("\n      "+t._s(t.$t("personal_hkid"))+"\n      "),r("i",{class:[1==t.select?"cubeic-ok":""]})]),t._v(" "),r("button",{staticClass:"passport",class:[2==t.select?"blue":""],on:{click:t.inputPassport}},[t._v("\n      "+t._s(t.$t("info_passport"))+"\n      "),r("i",{class:[2==t.select?"cubeic-ok":""]})])]),t._v(" "),r("div",{staticClass:"HK"},[r("span",{staticClass:"hkNumber"},[t._v(t._s(1==t.select?t.$t("account_info_hkid")+":":t.$t("info_passport")+":"))]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:1==t.select,expression:"select == 1"}],staticClass:"right"},[r("span",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.HKID1,expression:"form.HKID1"}],ref:"HKID1",staticClass:"IDnumber",attrs:{type:"text",placeholder:"A123456"},domProps:{value:t.form.HKID1},on:{input:function(e){e.target.composing||t.$set(t.form,"HKID1",e.target.value)}}})])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:2==t.select,expression:"select == 2"}],staticClass:"right"},[r("span",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.HKID_passport,expression:"form.HKID_passport"}],ref:"HKID_passport",staticClass:"IDnumber",attrs:{type:"text",placeholder:"A123456"},domProps:{value:t.form.HKID_passport},on:{input:function(e){e.target.composing||t.$set(t.form,"HKID_passport",e.target.value)}}})])])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:1==t.select,expression:"select==1? true:false"}],staticClass:"remark",staticStyle:{color:"rgb(74, 74, 74)"}},[r("p",[t._v(t._s(t.$t("card_hk_desc")))])])])},staticRenderFns:[]};var d={components:{WFormItem:r("VU/8")(l,m,!1,function(t){r("G0/3")},"data-v-c9cd2d36",null).exports},data:function(){return{formData:[],people:"",ages:"",adultNum:{adult:0,child:0},loading:!1}},computed:c()({},Object(u.c)(["travelInfo","userInfo","userId","protectorInfo","ageInfo","product_id"])),created:function(){this.$createToast({time:1e3,txt:this.$t("loading")}).show(),this.getFormData()},methods:c()({},Object(u.b)(["reset","setUserInfo","setProtectorInfo","setCertificateId","setadult"]),{confirm:function(){var t=this;return i()(s.a.mark(function e(){var r,a,n,i,o,c,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i in r=t.travelInfo.count,a=0,n=[],r)if(r[i]>0)for(o=0;o<r[i];o++)c="input"+a,n.push(t.$refs[c][0].form),a++;o=0;case 8:if(!(o<n.length)){e.next=37;break}if(""!=n[o].datebirth&&""!=n[o].givename&&""!=n[o].gender&&""!=n[o].surname){e.next=12;break}return t.$createToast({txt:t.$t("insurance_toast"),time:3e3,type:"txt"}).show(),e.abrupt("return",!1);case 12:if(""!=n[o].HKID1||""!=n[o].HKID_passport){e.next=15;break}return t.$createToast({txt:t.$t("insurance_toast"),time:3e3,type:"txt"}).show(),e.abrupt("return",!1);case 15:if(n[o].title!=t.$t("child")){e.next=24;break}if(!(t.getYears(n[o].datebirth)>=16)){e.next=22;break}return t.loading=!1,t.$createToast({txt:t.$t("children_Years"),time:3e3,type:"txt"}).show(),e.abrupt("return",!1);case 22:e.next=28;break;case 24:if(!(t.getYears(n[o].datebirth)<16)){e.next=28;break}return t.loading=!1,t.$createToast({txt:t.$t("companions_Years"),time:3e3,type:"txt"}).show(),e.abrupt("return",!1);case 28:return t.loading=!0,e.next=31,t.verifyUserFrom(n[o]);case 31:if(0!=(u=e.sent)){e.next=34;break}return e.abrupt("return",!1);case 34:o++,e.next=8;break;case 37:return e.next=39,t.verifyAge(n);case 39:if(e.sent){e.next=41;break}return e.abrupt("return",!1);case 41:for(o=0;o<n.length;o++)t.getYears(n[o].datebirth)>18?t.adultNum.adult++:t.adultNum.child++;1==u&&(t.setUserInfo(n),t.getYears(n[0].datebirth),t.setadult(t.adultNum),0==t.travelInfo.count.myself?t.$router.push({path:"/Policyholder"}):t.getYears(n[0].datebirth)<18?t.$router.push({path:"/Policyholder"}):t.getYears(n[0].datebirth)>18&&t.$router.push({path:"/Policyholder"}));case 43:case"end":return e.stop()}},e,t)}))()},getFormData:function(){var t=1,e=0,r={child:this.$t("child"),friends:this.$t("Family_friends"),myself:this.$t("ship_myself"),spouse:this.$t("ship_my_spouse")},a=this.travelInfo.count;for(var s in a)if(a[s]>0)for(var n=0;n<a[s];n++){if(this.userInfo)var i=this.userInfo[e].gender,o=this.userInfo[e].surname,c=this.userInfo[e].givename,u=this.userInfo[e].datebirth,l=this.userInfo[e].HKID1,m=this.userInfo[e].HKID_passport;e++,this.people++,this.formData.push({title:r[s],member:t++,gender:i||"",surname:o||"",givename:c||"",datebirth:u||"",HKID1:l||"",HKID_passport:m||""})}},verifyUserFrom:function(t){var e=this;return i()(s.a.mark(function r(){var a,n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=!1,""==t.HKID1){r.next=15;break}return n=t.HKID1,r.prev=4,r.next=7,e.$http.post("/wesupromo/web/validate/validateHKIDWithLng",{language:"tc",hkid:n});case 7:r.sent,r.next=15;break;case 10:return r.prev=10,r.t0=r.catch(4),e.loading=!1,r.t0.msg?e.$createToast({txt:r.t0.msg,time:3e3,type:"txt"}).show():e.$createToast({txt:e.$t("request_error_title"),time:3e3,type:"txt"}).show(),r.abrupt("return",!1);case 15:return a=!0,r.abrupt("return",a);case 18:case"end":return r.stop()}},r,e,[[4,10]])}))()},toPrePage:function(){this.$router.push("/Prompt")},getToday:function(t){var e=t.getFullYear(),r=t.getMonth()+1;r=r<10?"0"+r:r;var a=t.getDate();return e+"/"+r+"/"+(a=a<10?"0"+a:a)},getYears:function(t){var e=this.getToday(new Date),r=Math.ceil((new Date(e+" 00:00:00").getTime()-new Date(t.replace(/-/g,"/")+" 00:00:00").getTime())/864e5);return this.ages=Math.floor(r/365),this.ages},verifyAge:function(t){var e=this;return i()(s.a.mark(function r(){var a,n,i;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:for(a=[],n=0;n<t.length;n++)a.push({dob:t[n].datebirth});return r.prev=2,r.next=5,e.$http.post("/wesupromo/web/product/checkAge",{product_id:e.product_id,who_age:"insured",others_insured_list:a});case 5:if(100!=(i=r.sent).status||0!=i.data.checkAge){r.next=12;break}return e.loading=!1,e.$createToast({time:2e3,type:"txt",txt:e.$t("member_toast_age")}).show(),r.abrupt("return",!1);case 12:r.next=21;break;case 14:return r.prev=14,r.t0=r.catch(2),e.loading=!1,e.$createToast({time:3e3,type:"txt",txt:r.t0.msg}).show(),r.abrupt("return",!1);case 21:return r.abrupt("return",!0);case 22:case"end":return r.stop()}},r,e,[[2,14]])}))()}})},p={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page-wrap"},[r("div",{staticClass:"headTitle"},[r("i",{staticClass:"cubeic-arrow",on:{click:t.toPrePage}}),t._v(" "),r("p",[t._v(t._s(t.$t("account_add_member")))])]),t._v(" "),t._l(t.formData,function(t,e){return r("WFormItem",{key:e,ref:"input"+e,refInFor:!0,attrs:{formdata:t}})}),t._v(" "),r("div",{staticClass:"button-bar"},[r("button",{staticClass:"proceed",on:{click:t.confirm}},[t._v(t._s(t.$t("confirm")))])]),t._v(" "),r("cube-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]})],2)},staticRenderFns:[]};var f=r("VU/8")(d,p,!1,function(t){r("EpbD")},"data-v-698356e4",null);e.default=f.exports},EpbD:function(t,e){},"G0/3":function(t,e){}});